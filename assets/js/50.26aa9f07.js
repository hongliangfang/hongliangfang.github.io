(window.webpackJsonp=window.webpackJsonp||[]).push([[50],{367:function(e,n,s){"use strict";s.r(n);var t=s(7),r=Object(t.a)({},(function(){var e=this,n=e._self._c;return n("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[n("p",[n("RouterLink",{attrs:{to:"/01.科研学习/01.阅读记录/19.PDAC biomarkers.html"}},[e._v("PDAC biomarkers")])],1),e._v(" "),n("blockquote",[n("p",[e._v("这个文章，主要的内容其实就是这个算法，不少分析是有那么一点点印象的，只不过，WGNA的分析细节内容忘记了，所以后半部分的分析不清楚哦。但是这篇文章也让我意识到，技术不分优劣，加上好数据也能有很有意义的成果。")])]),e._v(" "),n("p",[e._v("几个参考学习链接：")]),e._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"https://cloud.tencent.com/developer/article/2056804",target:"_blank",rel:"noopener noreferrer"}},[e._v("主要参考：WGCNA加权基因共表达网络分析 -- 关联基因模块与表型"),n("OutboundLink")],1)]),e._v(" "),n("li",[n("a",{attrs:{href:"https://mp.weixin.qq.com/s/7xnrvovkUFr7A41wMWbDyg",target:"_blank",rel:"noopener noreferrer"}},[e._v("一文看懂WGCNA 分析(2019更新版) "),n("OutboundLink")],1)]),e._v(" "),n("li",[n("a",{attrs:{href:"https://mp.weixin.qq.com/s/OBvS0I7IUuwcChGoaJVgtQ",target:"_blank",rel:"noopener noreferrer"}},[e._v("一文掌握单细胞wgcna分析 (qq.com)"),n("OutboundLink")],1)]),e._v(" "),n("li",[n("a",{attrs:{href:"https://cloud.tencent.com/developer/article/2323311",target:"_blank",rel:"noopener noreferrer"}},[e._v("院士团队的WGCNA挖掘文章修改成为癌症转移与否关键模块"),n("OutboundLink")],1)]),e._v(" "),n("li",[n("a",{attrs:{href:"https://cloud.tencent.com/developer/article/2323187",target:"_blank",rel:"noopener noreferrer"}},[e._v("WGCNA仅仅是划分基因模块，其它都是附加分析"),n("OutboundLink")],1)])]),e._v(" "),n("p",[e._v("https://www.plob.org/article/14994.html")]),e._v(" "),n("p",[n("a",{attrs:{href:"https://mp.weixin.qq.com/s/6atAeTKzPtIvCdMmWPIJEw",target:"_blank",rel:"noopener noreferrer"}},[e._v("看完不会来找我"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("strong",[e._v("基本概念")])]),e._v(" "),n("p",[e._v("WGCNA（Weighted Gene Co-Expression Network Analysis ），即加权基因共表达网络分析，用于寻找高度相关的基因构成的基因模块module，利用模块特征基因eigengene（模块内第一主成分）或模块内的关键基因Hub gene来总结这些模块，将模块与样本性状进行关联。")]),e._v(" "),n("p",[e._v("主要目的是，寻找协同表达的基因模块/蛋白质模块，module，并探索基因/蛋白网络，与关注的表型之间的关联，以及网络中的核心基因/蛋白")]),e._v(" "),n("p",[e._v("主要步骤有两步，"),n("code",[e._v("表达量聚类分析")]),e._v("和"),n("code",[e._v("表型关联分析")]),e._v("，也就是找到表达量一致的基因或蛋白，然后联系到表型数据，做关联分析。详细步骤还包括基因之间相关系数计算，基因模块的确定，共表达网络，模块与形状关联四个步骤。")]),e._v(" "),n("p",[e._v("几个专业词汇")]),e._v(" "),n("ul",[n("li",[e._v("权重，weghted，基因与基因之间除了是否存在联系，还包括相关性的数值，也就是基因之间联系的强度（权重）")]),e._v(" "),n("li",[e._v("模块，module，表达模式相似的基因会被分分为一类，这样的一类基因为模块")]),e._v(" "),n("li",[e._v("eigengene，eigen + gene，基因和样本构成的矩阵")]),e._v(" "),n("li",[e._v("邻近矩阵，adjacency matrix，图的一种存储形式，用一个一维数组存放所有顶点数据，用一个二维数组存放顶点间关系（边或弧）的数据，这个二维数组称为邻近矩阵；WGCNA中是指基因与基因之间的相关性系数矩阵。")]),e._v(" "),n("li",[e._v("拓扑重叠矩阵，Topological Overlap Matrix，WGNA认为基因之间的简单的相关性不足以计算共表达，所以它利用上面的邻近矩阵，又计算了一个新的邻近矩阵。一般来说，TOM就是WGCNA分析的最终结果，后续的只是对TOM的下游注释。")])]),e._v(" "),n("p",[e._v("后续的分析还有：模块的功能富集，模块与性状之间的相关性，模块与样本之间的相关系数，找到模块的核心基因，利用关系预测基因功能等")]),e._v(" "),n("p",[n("strong",[e._v("基本流程")])]),e._v(" "),n("blockquote",[n("p",[e._v("构建共表达网络 → 识别模块 → 关联模块与表型信息 → 研究模块间关系 → 从感兴趣的模块中寻找感兴趣的驱动因素")])]),e._v(" "),n("p",[n("img",{attrs:{src:"https://s2.loli.net/2024/06/05/fYotxQa31P5ZhNy.png",alt:"image.png|400"}})]),e._v(" "),n("p",[n("strong",[e._v("注意事项")])]),e._v(" "),n("ul",[n("li",[e._v("样本数 ≥ 15")]),e._v(" "),n("li",[e._v("基因过滤方法，采用均值，方差，中位数，绝对中位差MAD等方法，过滤低表达或是样本间变化小的基因，但不建议用差异分析的方法进行过滤")]),e._v(" "),n("li",[e._v("输入数据如有批次效应，要先去除；处理RNAseq数据，需要采用DESeq2的varianceStabilizingTransformation方法，或将基因标准化后的数据（如FPKM、CPM等）进行log2(x+1)转化")]),e._v(" "),n("li",[e._v("经验软阈值power当无向网络在power小于15或有向网络power小于30内，计算出的power无法达到要求时（即没有一个power值可以使无标度网络图谱结构R^2达到0.8且平均连接度降到100以下），可采用经验power值：")])]),e._v(" "),n("table",[n("thead",[n("tr",[n("th",[e._v("Number of samples")]),e._v(" "),n("th",[e._v("Unsigned and signed hybrid networks")]),e._v(" "),n("th",[e._v("Signed networks")])])]),e._v(" "),n("tbody",[n("tr",[n("td",[e._v("less than 20")]),e._v(" "),n("td",[e._v("9")]),e._v(" "),n("td",[e._v("18")])]),e._v(" "),n("tr",[n("td",[e._v("20~30")]),e._v(" "),n("td",[e._v("8")]),e._v(" "),n("td",[e._v("16")])]),e._v(" "),n("tr",[n("td",[e._v("moer than 40")]),e._v(" "),n("td",[e._v("6")]),e._v(" "),n("td",[e._v("12")])])])]),e._v(" "),n("p",[n("strong",[e._v("尝试运行")])]),e._v(" "),n("p",[n("a",{attrs:{href:"https://cloud.tencent.com/developer/article/2056804",target:"_blank",rel:"noopener noreferrer"}},[e._v("主要参考代码"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("0、整理输入数据")]),e._v(" "),n("p",[e._v("两个数据：一个表达矩阵数据（行为样本，列为基因/蛋白）；一个临床特征/表型数据（行为样本，列为特征或表型）")]),e._v(" "),n("p",[e._v("1、数据指控")]),e._v(" "),n("p",[e._v("判断样品质量，系统聚类树 / 主成分分析，判断样本有无显著离群样本")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("WGCNA::goodSamplesGenes() # 质控样本和基因\n\n\n# 系统聚类树（计算、展示、删除）\nlibrary(WGCNA)\nhclust(dist(expression.data.table))\nplotDendroAndColors()\ncutreeStatic()\n\n# 主成分分析（计算、展示）\nlibrary(FactoMineR)\nlibrary(factoextra)\nPCA()\nfviz_pca_ind()\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br"),n("span",{staticClass:"line-number"},[e._v("12")]),n("br"),n("span",{staticClass:"line-number"},[e._v("13")]),n("br"),n("span",{staticClass:"line-number"},[e._v("14")]),n("br")])]),n("p",[e._v("2、挑选阈值")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("# library(WGCNA)\npickSoftThreshold()\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br")])]),n("p",[e._v("3、构建网络，识别模块")]),e._v(" "),n("p",[e._v("构建加权共表达网络可以一步法，或分步法，一般选择一步法，想要调整得到的基因模块时，分步法更灵活")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("# library(WGCNA)\n\n# 一步法\nblockwiseModules() # 构建模块\n\nplotDendroAndColors() # 展示模块（一个黑不溜秋聚类线+五彩聚类方块）\n\n\n# 分步法\nadjacency()\nTOMsimilarity()\nhclust()\ncutreeDynamic()\nmoduleEigengenes()\nmergeCloseModules()\n\nplotDendroAndColors()\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br"),n("span",{staticClass:"line-number"},[e._v("12")]),n("br"),n("span",{staticClass:"line-number"},[e._v("13")]),n("br"),n("span",{staticClass:"line-number"},[e._v("14")]),n("br"),n("span",{staticClass:"line-number"},[e._v("15")]),n("br"),n("span",{staticClass:"line-number"},[e._v("16")]),n("br"),n("span",{staticClass:"line-number"},[e._v("17")]),n("br")])]),n("p",[e._v("4、关联模块和表型")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("library(WGCNA)\n\nmoduleEigengenes()$eigengenes # 得到模块基因\norderMEs() # 把特征向量放在一起\ncor()\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br")])])])}),[],!1,null,null,null);n.default=r.exports}}]);