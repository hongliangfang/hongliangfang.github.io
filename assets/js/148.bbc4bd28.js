(window.webpackJsonp=window.webpackJsonp||[]).push([[148],{461:function(e,s,n){"use strict";n.r(s);var a=n(7),t=Object(a.a)({},(function(){var e=this,s=e._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("div",{staticClass:"custom-block note"},[s("p",{staticClass:"custom-block-title"},[e._v("笔记")]),e._v(" "),s("p",[e._v("2024-05-31，偶然间看到这个推送，想看看，学习一下")])]),e._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://mp.weixin.qq.com/s/r_Cs3KKSwSY41nc9geQkHg",target:"_blank",rel:"noopener noreferrer"}},[e._v("胃癌单细胞数据集GSE163558复现（一）：数据下载、整理与读取 (qq.com)"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://mp.weixin.qq.com/s/0ZchFlhb4cZeLzuMNpgSBg",target:"_blank",rel:"noopener noreferrer"}},[e._v("胃癌单细胞数据集GSE163558复现（一）：数据下载、整理与读取 (qq.com)"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://mp.weixin.qq.com/s/_F9X-OnGwwT0JT41Obu-Mg",target:"_blank",rel:"noopener noreferrer"}},[e._v("胃癌单细胞数据集GSE163558复现(二)：Seurat V5标准流程 (qq.com)"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://mp.weixin.qq.com/s/sDysW86vopgm_zSMmpfG1w",target:"_blank",rel:"noopener noreferrer"}},[e._v("胃癌单细胞数据集GSE163558复现(三)：细胞分群注释 (qq.com)"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://mp.weixin.qq.com/s/rrz3PW7euM7hCX2Ci6XwJQ",target:"_blank",rel:"noopener noreferrer"}},[e._v("胃癌单细胞数据集GSE163558复现(四)：细胞分群可视化 (qq.com)"),s("OutboundLink")],1)])]),e._v(" "),s("p",[e._v("视频："),s("a",{attrs:{href:"https://www.bilibili.com/video/BV1JD421g7H9",target:"_blank",rel:"noopener noreferrer"}},[e._v("胃癌单细胞数据挖掘视频教程"),s("OutboundLink")],1)]),e._v(" "),s("p",[e._v("数据："),s("a",{attrs:{href:"https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE163558",target:"_blank",rel:"noopener noreferrer"}},[e._v("GEO Accession viewer (nih.gov)"),s("OutboundLink")],1)]),e._v(" "),s("p",[e._v("已经下载：文献附件/GSE163558")]),e._v(" "),s("p",[e._v("2024-06-16，视频记录")]),e._v(" "),s("p",[e._v("上皮细胞，T、B细胞，内皮细胞，炎症性相关成纤维细胞，髓系细胞，淋巴细胞亚群来源的耗竭CD8T细胞")]),e._v(" "),s("p",[e._v("TCGA-STAD的Top差异基因来注释恶性上皮和正常上皮，不能一竿子打死上皮细胞（全部注释为恶性上皮）")]),e._v(" "),s("p",[e._v("immune cell：CD45+，PTPRC")]),e._v(" "),s("p",[e._v("T cell：CD4")]),e._v(" "),s("p",[e._v("B cell：MS4A1，CD79A")]),e._v(" "),s("p",[e._v("NK cell：")]),e._v(" "),s("p",[e._v("Myeloid cell：KIT")]),e._v(" "),s("p",[e._v("Fibroblast cell：FGF7，LUM")]),e._v(" "),s("p",[e._v("Epithelial cell：EPCAM")]),e._v(" "),s("p",[e._v("生信技能树\n上皮细胞：EPCAM，KRT19，CLDN4\n基质细胞：PECAM1，CL01A2，VWF\nT细胞：CD30D，CD3E，CD8A，CD4，CD2\n内皮细胞：CDH5，PECAM1，VWF\n成纤维细胞：LUM，FGF7，MME\n巨噬细胞：AIF1，C1QC，C1QB，LYZ\n增殖细胞：MKI67，STMN1，PCNA\n肥大细胞：CDA3，CST3，KIT，TPSAB1，TPSB2\n中性粒细胞：GOS2，S100A9，A100A8，CXCL8\nNK细胞：KLRD1，GNLY，KLRF1，AREG，XCL2，HSPA6\nB细胞：MS4A1，CD19，CD79A，IGHG1，MZB1，SDC1\n髓系：CSF1R，CSF3R，CD68")]),e._v(" "),s("p",[e._v("Endothelial cell：VWF")]),e._v(" "),s("p",[e._v("plasma cell / 浆细胞：IGHG1")]),e._v(" "),s("p",[e._v("MKI67，增值信号\nCLDN7，CLDN4，TFF3，肿瘤的特异性基因\nLIPF，MUC5AC，GKN1，PGC，胃粘液和消化酶相关的基因")]),e._v(" "),s("p",[e._v("SRGN，VIM，LAPTM5A，上皮-间充质转化相关的基因")]),e._v(" "),s("p",[e._v("CD44，PROM1（CD133），LGR5，SOX2，TFRC（CD71），CXCR4，JAG1，癌症干细胞CSC的标志物")]),e._v(" "),s("p",[e._v("MKI67，IGF1，ITGB2，PDGFC，JAG1，PHGDH增殖相关的基因")]),e._v(" "),s("p",[e._v("VIM，SNAI1，MMP9，AREG，ARID5B，FAT1迁移相关的基因")]),e._v(" "),s("p",[e._v("几个基因一起评分后绘图，我觉得应该会更科学些")]),e._v(" "),s("p",[e._v("Featureplot，可以若干基因一起")]),e._v(" "),s("p",[e._v("RStudio，也可以当成服务端（网页版那种工具）")]),e._v(" "),s("ul",[s("li",[e._v("[ ] biotrainee.vip:9013")]),e._v(" "),s("li",[e._v("[ ] 能不能也实现RStudio作为服务器")]),e._v(" "),s("li",[e._v("[ ] 还有jupyter顺便一起")]),e._v(" "),s("li",[e._v("[ ] 语雀看着蛮好用的")])]),e._v(" "),s("p",[e._v("批量读取后，"),s("code",[e._v("JoinLayers")])]),e._v(" "),s("p",[s("code",[e._v("library(UCell)")]),e._v("，是可以拿几十个基因一起评价细胞的包")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("marker <- list(top_up_genes,top_down_genes)\nnames(marker[1]) <- 'tumor'\nnames(marker[2]) <- 'normal'\nscore <- AddModuleScore_UCell(sce,features=marker)\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br")])]),s("p",[s("code",[e._v("tumor <- sce[,sce$score1 %in% c('malignant')]")])]),e._v(" "),s("p",[s("code",[e._v("tumor$celltype <- paste0('G',tumor$seurat_clusters)")])]),e._v(" "),s("p",[s("code",[e._v("ClusterProfile -- compareCluster")])]),e._v(" "),s("p",[s("code",[e._v("set.seed(123)")]),e._v("，这种思想，方便重复")]),e._v(" "),s("p",[e._v("常用"),s("code",[e._v("table")]),e._v(" -- "),s("code",[e._v("table(sce@meta.data$RNA_snn_res.o.1)")])]),e._v(" "),s("p",[e._v("根据某一列的条件创建新的一列 -- "),s("code",[e._v("df$score1 = 'unknown'")]),e._v("，"),s("code",[e._v("df[df&score > 0.02,]$score1 = 'malignant'")])]),e._v(" "),s("p",[e._v("复杂的比例图也不错")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("library(gplots)\n\ntb = table(sce$tissue,sce$score1)\nballoonplot(tb)\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br")])]),s("p",[e._v("下面这几步好像很快的就整理出来绘制比例图的数据了")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("bar_data <- as.data.frame(tb)\n\nbar_per <- bar_data %>%\n\tgroup_by(Var1) %>%\n\tmutate(sum(Freq))) %>%\n\tmutate(percent = Freq / `sum(Freq)`)\n\nggplot()\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br"),s("span",{staticClass:"line-number"},[e._v("8")]),s("br")])]),s("p",[e._v("基因表达热图（看着还不错）")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("Idents(scRNA)\nscRNA1 = scRNA\nacRNA1 <- ScaleData(scRNA1,fetures = rownames(scRNA1))\n\ncells = subset(scRNA1,downsample=300) # 300个细胞，可以运行更快，使图更好看\n\ngene_order <- c('CD63','CLDN4',,,,,)\n\ngene <- factor(gene_order,levels = unique(gene_order))\ncells2 <- cells[rownames(cells) %in% gene,]\ndf <- as.data.frame(AverageExpression(object = cells2)$RNA)\ndf <- df[gene_order]\ndf = na.omit(df)\n\npheatmap(df,\n\tcluster_rows = FALSE,\n\tcluster_cols = FALSE,\n\tshow_colnames = TRUE, \n\tscale = 'row',\n\tgaps_row = c(seq(3,11,3)),\n\tgaps_col = c(1:4),\n\t)\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br"),s("span",{staticClass:"line-number"},[e._v("8")]),s("br"),s("span",{staticClass:"line-number"},[e._v("9")]),s("br"),s("span",{staticClass:"line-number"},[e._v("10")]),s("br"),s("span",{staticClass:"line-number"},[e._v("11")]),s("br"),s("span",{staticClass:"line-number"},[e._v("12")]),s("br"),s("span",{staticClass:"line-number"},[e._v("13")]),s("br"),s("span",{staticClass:"line-number"},[e._v("14")]),s("br"),s("span",{staticClass:"line-number"},[e._v("15")]),s("br"),s("span",{staticClass:"line-number"},[e._v("16")]),s("br"),s("span",{staticClass:"line-number"},[e._v("17")]),s("br"),s("span",{staticClass:"line-number"},[e._v("18")]),s("br"),s("span",{staticClass:"line-number"},[e._v("19")]),s("br"),s("span",{staticClass:"line-number"},[e._v("20")]),s("br"),s("span",{staticClass:"line-number"},[e._v("21")]),s("br"),s("span",{staticClass:"line-number"},[e._v("22")]),s("br")])]),s("p",[e._v("小提琴图（可以统计分析的那种），很不错，想办法找找尝试一下")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("metadata\na['CD44'] \nidentical(colnames(a),colnames(b))\n\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br")])]),s("p",[s("code",[e._v('devtools::install_github("navinlabcode/copykat")')]),e._v(" "),s("code",[e._v("library(copykat)")])])])}),[],!1,null,null,null);s.default=t.exports}}]);