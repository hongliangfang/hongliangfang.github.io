(window.webpackJsonp=window.webpackJsonp||[]).push([[49],{366:function(a,s,n){"use strict";n.r(s);var e=n(7),t=Object(e.a)({},(function(){var a=this,s=a._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("p",[a._v("有一些简单易行的生存分析资源，为何不白嫖一下试一试呢？")]),a._v(" "),s("h2",{attrs:{id:"线上分析网站"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#线上分析网站"}},[a._v("#")]),a._v(" 线上分析网站")]),a._v(" "),s("p",[s("a",{attrs:{href:"https://www.jianshu.com/p/1501dbb94ccd",target:"_blank",rel:"noopener noreferrer"}},[a._v("三大经典在线生存分析工具测评 - 简书 (jianshu.com)"),s("OutboundLink")],1)]),a._v(" "),s("p",[a._v("GEPIA2："),s("a",{attrs:{href:"http://gepia2.cancer-pku.cn/#index",target:"_blank",rel:"noopener noreferrer"}},[a._v("GEPIA 2 (cancer-pku.cn)"),s("OutboundLink")],1)]),a._v(" "),s("blockquote",[s("p",[a._v("出图快，可以简单尝试一下，颜色可调，但是截距，Cutoff等等数据分类方式不能调整")])]),a._v(" "),s("p",[a._v("Kaplan-Meier Plotter："),s("a",{attrs:{href:"https://kmplot.com/analysis/",target:"_blank",rel:"noopener noreferrer"}},[a._v("Kaplan-Meier plotter (kmplot.com)"),s("OutboundLink")],1)]),a._v(" "),s("blockquote",[s("p",[a._v("速度很快，但是配色不可以调，数据不便调整")])]),a._v(" "),s("p",[a._v("OncoLnc："),s("a",{attrs:{href:"http://www.oncolnc.org/",target:"_blank",rel:"noopener noreferrer"}},[a._v("OncoLnc"),s("OutboundLink")],1)]),a._v(" "),s("blockquote",[s("p",[a._v("数据多，可导出原始数据，还可以适当调整数据分类方式")])]),a._v(" "),s("p",[a._v("如果想要自己分析，数据可以从哪里白嫖一下嘞？")]),a._v(" "),s("h2",{attrs:{id:"数据来源"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#数据来源"}},[a._v("#")]),a._v(" 数据来源")]),a._v(" "),s("p",[a._v("oncoPredict: an R package for predicting in vivo or cancer patient drug response and biomarkers from cell line screening data")]),a._v(" "),s("p",[s("a",{attrs:{href:"https://www.cancer.gov/ccg/research/genome-sequencing/tcga",target:"_blank",rel:"noopener noreferrer"}},[a._v("The Cancer Genome Atlas Program (TCGA) - NCI"),s("OutboundLink")],1)]),a._v(" "),s("p",[s("a",{attrs:{href:"https://portal.gdc.cancer.gov/",target:"_blank",rel:"noopener noreferrer"}},[a._v("GDC (cancer.gov)"),s("OutboundLink")],1)]),a._v(" "),s("p",[s("a",{attrs:{href:"https://xenabrowser.net/datapages/",target:"_blank",rel:"noopener noreferrer"}},[a._v("UCSC Xena (xenabrowser.net)"),s("OutboundLink")],1)]),a._v(" "),s("p",[s("a",{attrs:{href:"https://mp.weixin.qq.com/s/S7s6topP0SfRAZ8YCHy7yQ",target:"_blank",rel:"noopener noreferrer"}},[a._v("新版TCGA数据分析实战——数据下载与整理 (qq.com)"),s("OutboundLink")],1)]),a._v(" "),s("p",[s("a",{attrs:{href:"https://mp.weixin.qq.com/s/_xVOBTJ0DkpxiIj03NY6TQ",target:"_blank",rel:"noopener noreferrer"}},[a._v("（小白）看完还不会来揍/找我 | TCGA 与 GTEx 数据库联合分析 | 附完整代码 + 注释 (qq.com)"),s("OutboundLink")],1)]),a._v(" "),s("p",[s("a",{attrs:{href:"https://mp.weixin.qq.com/s/8Q7Rb7K-Mrs_fA5c5OvyqA",target:"_blank",rel:"noopener noreferrer"}},[a._v("（小白）TCGA 样本命名规则详解 | 快速获取样本类型、组织来源等分组信息 (qq.com)"),s("OutboundLink")],1)]),a._v(" "),s("p",[s("a",{attrs:{href:"https://mp.weixin.qq.com/s/pv49e-lf9ZnEAmSiQIflIQ",target:"_blank",rel:"noopener noreferrer"}},[a._v("（小白）看完还不会来揍/找我 | 差异分析三巨头 —— DESeq2、edgeR 和 limma 包 | 附完整代码 + 注释 (qq.com)"),s("OutboundLink")],1)]),a._v(" "),s("p",[a._v("读取和处理")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('fread("./data/TCGA-BRCA.htseq_counts.tsv.gz", header = T, sep = \'\\t\', data.table = F)\n\nfread("./data/gencode.v22.annotation.gene.probeMap", header = T, sep = \'\\t\', data.table = F)\n\nmerge(gene_id, exp_brca, by.x = "id", by.y  = "Ensembl_ID") # 合并\n\ndistinct(exp_brca, gene, .keep_all = T) # 去重\n\nsubstring(colnames(exp_brca), 14, 15)\n\n')])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br")])]),s("p",[a._v("分分类，准备画个火山图")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('# 分类判断\nlogFC = 2.5  \nP.Value = 0.01  \nk1 <- (DEG_deseq2$pvalue < P.Value) & (DEG_deseq2$log2FoldChange < -logFC)\nk2 <- (DEG_deseq2$pvalue < P.Value) & (DEG_deseq2$log2FoldChange > logFC)\nDEG_deseq2 <- mutate(DEG_deseq2, change = ifelse(k1, "down", ifelse(k2, "up", "stable")))  \ntable(DEG_deseq2$change)\n\n\n# 火山图\np <- ggplot(data = DEG_deseq2,   \n            aes(x = log2FoldChange,   \n                y = -log10(pvalue))) +  \n  geom_point(alpha = 0.4, size = 3.5,   \n             aes(color = change)) +  \n  ylab("-log10(Pvalue)")+  \n  scale_color_manual(values = c("blue4", "grey", "red3"))+  \n  geom_vline(xintercept = c(-logFC, logFC), lty = 4, col = "black", lwd = 0.8) +  \n  geom_hline(yintercept = -log10(P.Value), lty = 4, col = "black", lwd = 0.8) +  \n  theme_bw()  \np\n\n# 热图\ndeg_opt <- DEG_deseq2 %>% filter(DEG_deseq2$change != "stable")  \nexp_brca_heatmap <- exp_brca %>% filter(rownames(exp_brca) %in% rownames(deg_opt))  \nannotation_col <- data.frame(group = group)  \nrownames(annotation_col) <- colnames(exp_brca_heatmap)   \n  \np1 <- pheatmap(exp_brca_heatmap, show_colnames = F, show_rownames = F,  \n               scale = "row",  \n               cluster_cols = F,  \n               annotation_col = annotation_col,  \n               breaks = seq(-3, 3, length.out = 100))   \np1\n\n\n# 保存图片\nggsave(filename = "./figure/heatmap_plot_deseq2.pdf", plot = p1, device = "pdf", width = 5, height = 6)  \ndev.off()\n')])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br"),s("span",{staticClass:"line-number"},[a._v("13")]),s("br"),s("span",{staticClass:"line-number"},[a._v("14")]),s("br"),s("span",{staticClass:"line-number"},[a._v("15")]),s("br"),s("span",{staticClass:"line-number"},[a._v("16")]),s("br"),s("span",{staticClass:"line-number"},[a._v("17")]),s("br"),s("span",{staticClass:"line-number"},[a._v("18")]),s("br"),s("span",{staticClass:"line-number"},[a._v("19")]),s("br"),s("span",{staticClass:"line-number"},[a._v("20")]),s("br"),s("span",{staticClass:"line-number"},[a._v("21")]),s("br"),s("span",{staticClass:"line-number"},[a._v("22")]),s("br"),s("span",{staticClass:"line-number"},[a._v("23")]),s("br"),s("span",{staticClass:"line-number"},[a._v("24")]),s("br"),s("span",{staticClass:"line-number"},[a._v("25")]),s("br"),s("span",{staticClass:"line-number"},[a._v("26")]),s("br"),s("span",{staticClass:"line-number"},[a._v("27")]),s("br"),s("span",{staticClass:"line-number"},[a._v("28")]),s("br"),s("span",{staticClass:"line-number"},[a._v("29")]),s("br"),s("span",{staticClass:"line-number"},[a._v("30")]),s("br"),s("span",{staticClass:"line-number"},[a._v("31")]),s("br"),s("span",{staticClass:"line-number"},[a._v("32")]),s("br"),s("span",{staticClass:"line-number"},[a._v("33")]),s("br"),s("span",{staticClass:"line-number"},[a._v("34")]),s("br"),s("span",{staticClass:"line-number"},[a._v("35")]),s("br"),s("span",{staticClass:"line-number"},[a._v("36")]),s("br"),s("span",{staticClass:"line-number"},[a._v("37")]),s("br"),s("span",{staticClass:"line-number"},[a._v("38")]),s("br"),s("span",{staticClass:"line-number"},[a._v("39")]),s("br")])]),s("h2",{attrs:{id:"生存分析基本概念"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#生存分析基本概念"}},[a._v("#")]),a._v(" 生存分析基本概念")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://s2.loli.net/2024/04/02/GvJtFCQbiBXE85c.png",alt:"生存分析图示.png|400"}})]),a._v(" "),s("p",[a._v("生存分析是什么？")]),a._v(" "),s("ul",[s("li",[a._v("时间维度上，相关因素，对生存事件的影响情况")])]),a._v(" "),s("p",[a._v("怎么做生存分析？（data，code）")]),a._v(" "),s("ul",[s("li",[a._v("数据类型是，时间-事件的资料，为什么是事件呢？因为生存不一定是指死亡，也可以是指无病生存期之类的，只要是我们研究感兴趣的终点事件就可以。截尾值censored value，研究对象，因为各种原因，不能提供后续数据。")]),a._v(" "),s("li",[a._v("“死亡速度”，好像是看单位时间内的死亡速度有多快。产生“阳性事件”的快慢。")])]),a._v(" "),s("p",[a._v("生存分析的一般内容：")]),a._v(" "),s("ol",[s("li",[a._v("描述生存过程，估计生存曲线 → 寿命表法，Kalplan-Meier法")]),a._v(" "),s("li",[a._v("生存时间分布的组间比较 → Log rank检验，广义秩和检验")]),a._v(" "),s("li",[a._v("评价影响因素 → Cox回归模型")])]),a._v(" "),s("p",[a._v("研究开始到结束，这个时间段叫“生存时间”，两个时间点间，出现了“终点事件”以及其观察数据叫我完全数据，未出现“终点事件”中途退出的情况为删失数据。")]),a._v(" "),s("p",[a._v("如何进行描述统计呢？")]),a._v(" "),s("ul",[s("li",[a._v("Kaplan-Meier估计方法：将参与人员按照参与时间的长短排序，逐个时间点计算生存率。")])]),a._v(" "),s("p",[a._v("如何进行检验呢？")]),a._v(" "),s("ul",[s("li",[a._v("Log-rank检验，或Breslow检验，进行假设检验。")])]),a._v(" "),s("p",[a._v("基础概念")]),a._v(" "),s("ul",[s("li",[a._v("survival analysis，生存分析")]),a._v(" "),s("li",[a._v("event，终点事件")]),a._v(" "),s("li",[a._v("survival time，起止时间间隔 / failure time，失效时间")]),a._v(" "),s("li",[a._v("censoring，删失/截堵")])]),a._v(" "),s("p",[s("strong",[a._v("所以数据最重要的是，时间（横坐标），发生事件数量，可以算出比例（纵坐标）！")]),s("br"),a._v(" "),s("strong",[a._v("再多加一列数据是其他因素（分开曲线），变成若干条生存曲线在一张图上，用Log-rank检验。")])]),a._v(" "),s("p",[a._v("注意：样本量越大，曲线越平滑，误差越大，越容易出现统计学差异；随访时间越长，越容易出现统计学差异；生存曲线与X轴交叉，可能是研究对象全部发生终点事件，还有可能失访了；生存曲线下方最好标识分组的依据，样本量，易看，说服力强。")]),a._v(" "),s("p",[a._v("详细介绍"),s("a",{attrs:{href:"http://thisis.yorven.site/blog/index.php/2020/04/06/survival-analysis/",target:"_blank",rel:"noopener noreferrer"}},[a._v("生存分析 简明教程 | Kaplan-Meier | Cox 比例风险回归模型"),s("OutboundLink")],1)]),a._v(" "),s("p",[a._v("TCGA study abbreviations")]),a._v(" "),s("h2",{attrs:{id:"实现survival"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#实现survival"}},[a._v("#")]),a._v(" 实现Survival")]),a._v(" "),s("p",[s("a",{attrs:{href:"https://mp.weixin.qq.com/s/GSVFfEVT3V5BYQONp4Y1bQ",target:"_blank",rel:"noopener noreferrer"}},[a._v("看完不会来揍我 | 生存分析详解 | 从基础概念到生存曲线绘制 | 代码注释 + 结果解读"),s("OutboundLink")],1)]),a._v(" "),s("p",[a._v("实现的一种方式，其中最重要的就是"),s("code",[a._v("OS.time")]),a._v("，"),s("code",[a._v("OS")]),a._v("这一列时间，一列生存与否的信息")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('surdata<-read.table("D:/Survival_inputdata.txt",sep="\\t",header=TRUE) \nsurdata<-surdata[surdata$Group=="GC",]\n\nlibrary(survival)\nlibrary(survminer)\n\npart_data<-na.omit(surdata[,c(2,4,5)])  ##colnames: "mRNAsi, OS, OS.time"\n\npart_data <- part_data %>%\n  dplyr::mutate(Type = case_when(\n    CD44 < mean(part_data[,1]) ~ \'low\',\n    CD44 > mean(part_data[,1]) ~ \'high\'\n    ))\n\ntable(part_data$Type)\npart_data <- part_data[part_data$Type != "Ns",]\n\nres.cox <- coxph(Surv(OS.time, OS) ~ Type, data = part_data)\nres.cox\n\nfit <- survfit(Surv(OS.time, OS) ~ Type, data = part_data)\nfit\nsummary(fit)\n\np <- ggsurvplot(fit,\n              # palette = c("#00599F","#d80700"),\n              # pval =TRUE,\n              # conf.int =TRUE,xlab ="Time",\n              # surv.median.line = "hv",\n              #legend.title="标记",\n              #legend.labs=c("CD44.H (n=219)","CD44.L (n=190)"),\n              #title="Overall Survival(OS)",\n              )\np\n')])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br"),s("span",{staticClass:"line-number"},[a._v("13")]),s("br"),s("span",{staticClass:"line-number"},[a._v("14")]),s("br"),s("span",{staticClass:"line-number"},[a._v("15")]),s("br"),s("span",{staticClass:"line-number"},[a._v("16")]),s("br"),s("span",{staticClass:"line-number"},[a._v("17")]),s("br"),s("span",{staticClass:"line-number"},[a._v("18")]),s("br"),s("span",{staticClass:"line-number"},[a._v("19")]),s("br"),s("span",{staticClass:"line-number"},[a._v("20")]),s("br"),s("span",{staticClass:"line-number"},[a._v("21")]),s("br"),s("span",{staticClass:"line-number"},[a._v("22")]),s("br"),s("span",{staticClass:"line-number"},[a._v("23")]),s("br"),s("span",{staticClass:"line-number"},[a._v("24")]),s("br"),s("span",{staticClass:"line-number"},[a._v("25")]),s("br"),s("span",{staticClass:"line-number"},[a._v("26")]),s("br"),s("span",{staticClass:"line-number"},[a._v("27")]),s("br"),s("span",{staticClass:"line-number"},[a._v("28")]),s("br"),s("span",{staticClass:"line-number"},[a._v("29")]),s("br"),s("span",{staticClass:"line-number"},[a._v("30")]),s("br"),s("span",{staticClass:"line-number"},[a._v("31")]),s("br"),s("span",{staticClass:"line-number"},[a._v("32")]),s("br"),s("span",{staticClass:"line-number"},[a._v("33")]),s("br"),s("span",{staticClass:"line-number"},[a._v("34")]),s("br")])]),s("h2",{attrs:{id:"统计分析-cox"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#统计分析-cox"}},[a._v("#")]),a._v(" 统计分析/Cox")]),a._v(" "),s("p",[a._v("下面这个教程真的很棒！")]),a._v(" "),s("p",[s("a",{attrs:{href:"https://mp.weixin.qq.com/s/DrY69gY7cPE7OocFQ_8iVA",target:"_blank",rel:"noopener noreferrer"}},[a._v("构建 Cox 比例风险回归模型 | 绘制森林图 (forestplot) | 附完整代码 + 注释 (qq.com)"),s("OutboundLink")],1)]),a._v(" "),s("p",[a._v("变量：分类变量，分级变量，数值变量")]),a._v(" "),s("ul",[s("li",[a._v("单因素cox（分析某个因素的时候，不考虑其他因素的变化）")]),a._v(" "),s("li",[a._v("多因素cox（分析某个因素的同时，还考虑上其他因素的变化）")])]),a._v(" "),s("p",[a._v("主要的包是："),s("code",[a._v("survival")]),a._v("，"),s("code",[a._v("survminer")]),s("br"),a._v("\n主要的函数是：")]),a._v(" "),s("ul",[s("li",[a._v("公式："),s("code",[a._v("Surv(Time, Status) ~ Stage")])]),a._v(" "),s("li",[a._v("进行分析：")]),a._v(" "),s("li",[s("code",[a._v("survfit(Surv(Time, Status) ~ Stage, data = survival_data)")])]),a._v(" "),s("li",[s("code",[a._v("coxph(Surv(Time, Status) ~ Stage, data = survival_data)")])]),a._v(" "),s("li",[a._v("提取结果："),s("code",[a._v("summary(x)")]),a._v("，"),s("code",[a._v('signif(x$wald["pvalue"], digits = 2)')])])]),a._v(" "),s("p",[a._v("主要的结果（要用"),s("code",[a._v("summary")]),a._v("总结）：")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("res_cox <- coxph(Surv(Time, Status) ~ Stage, data = tcga_gbmlgg_cli)  \nsummary(res_cox)  \n\n\n# Call:  \n# coxph(formula = Surv(Time, Status) ~ Stage, data = tcga_gbmlgg_cli)  \n#   \n# n= 670, number of events= 255   \n# (4 observations deleted due to missingness)  \n#   \n#                   coef exp(coef) se(coef) z Pr(>|z|)      \n#   StageWHO III  1.1888    3.2833   0.1995  5.959 2.54e-09 ***  \n#   StageWHO IV   2.9183   18.5107   0.2013 14.497  < 2e-16 ***  \n#   ---  \n#   Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1  \n#   \n#          exp(coef) exp(-coef) lower .95 upper .95  \n# StageWHO III     3.283    0.30458     2.221     4.854  \n# StageWHO IV     18.511    0.05402    12.476    27.465  \n#   \n# Concordance= 0.786  (se = 0.013 )  \n# Likelihood ratio test= 276.2  on 2 df,   p=<2e-16  \n# Wald test            = 259.6  on 2 df,   p=<2e-16  \n# Score (logrank) test = 376.8  on 2 df,   p=<2e-16\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br"),s("span",{staticClass:"line-number"},[a._v("13")]),s("br"),s("span",{staticClass:"line-number"},[a._v("14")]),s("br"),s("span",{staticClass:"line-number"},[a._v("15")]),s("br"),s("span",{staticClass:"line-number"},[a._v("16")]),s("br"),s("span",{staticClass:"line-number"},[a._v("17")]),s("br"),s("span",{staticClass:"line-number"},[a._v("18")]),s("br"),s("span",{staticClass:"line-number"},[a._v("19")]),s("br"),s("span",{staticClass:"line-number"},[a._v("20")]),s("br"),s("span",{staticClass:"line-number"},[a._v("21")]),s("br"),s("span",{staticClass:"line-number"},[a._v("22")]),s("br"),s("span",{staticClass:"line-number"},[a._v("23")]),s("br"),s("span",{staticClass:"line-number"},[a._v("24")]),s("br")])]),s("ul",[s("li",[s("p",[a._v("coef：模型系数，表示在每个阶段特定条件下，生存时间的对数风险增加了多少")])]),a._v(" "),s("li",[s("p",[a._v("exp(coef)：模型系数的指数，表示相对风险（hazard ratio，也叫风险比，风险率）")])]),a._v(" "),s("li",[s("p",[a._v("se(coef)：模型系数的标准误差，用于表示估计的不确定性")])]),a._v(" "),s("li",[s("p",[a._v("z：z值，用于检验模型系数是否显著，越大系数在统计上越显著")])]),a._v(" "),s("li",[s("p",[a._v("Pr(>|z|)：z值对应的p值，p值非常小，表示这些系数的影响是显著的")])]),a._v(" "),s("li",[s("p",[a._v("Signif.codes：显著性水平，"),s("code",[a._v("*")]),a._v("数量和"),s("code",[a._v(".")]),a._v("分别代表不同显著水平")])]),a._v(" "),s("li",[s("p",[a._v("exp(coef)，表格，提供了模型系数的指数形式，及其对应的95%置信区间")])]),a._v(" "),s("li",[s("p",[a._v("Concordance：模型的性能指标，衡量模型对观测数据的预测能力（0.786已经表示模型的预测能力相对较好）")])]),a._v(" "),s("li",[s("p",[a._v("Likelihoood ratio test，Wald test，Score（logrank） test，不同的检验方法，用于评估模型的拟合质量")])])]),a._v(" "),s("p",[a._v("实现代码：")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('library(survival)\nlibrary(survminer)\n\ntcga_gbmlgg_cli <- readRDS("./cox_data/tcga_gbmlgg_cli.rds")\ncolnames(tcga_gbmlgg_cli) <- c("Sample", "Time", "Status", "Gender", "Age", "IDH_status", "MGMT_promoter_status", "Stage", "Group")\nhead(tcga_gbmlgg_cli)\n\n\n\n### 单因素cox分析\nres_cox <- coxph(Surv(Time, Status) ~ Stage, data = tcga_gbmlgg_cli)\nsummary(res_cox)\nfit <- survfit(Surv(Time, Status) ~ Stage, data = tcga_gbmlgg_cli)\nfit\np<-ggsurvplot(fit,\n              #pval =TRUE,\n              #conf.int =TRUE,\n              #xlab = "Time", \n              #ylab = "Survival probability",\n              #surv.median.line = "hv",\n              #palette = c("#00599F","#d80700"),\n              )\np\n\n\n\n### 批量 单因素cox 分析\n# 提取我们想要关注的 特征\ncan <- colnames(tcga_gbmlgg_cli)[4:7]\ncan\n\n# 构建公式，循环对每个特征做单因素cox回归分析\nuni_sur <- sapply(can, function(x) as.formula(paste(\'Surv(Time, Status)~\', x)))\nuni_sur\nuni_cox <- lapply(uni_sur, function(x){coxph(x, data = tcga_gbmlgg_cli)})\nuni_cox\n\n# 创建一个列表 uni_results，用于存储每个生存分析模型的结果\nuni_results <- lapply(uni_cox, function(x) {\n  # lapply的功能：批量进行：x <- uni_cox$IDH_status\n  # 从每个模型的摘要中提取相关信息\n  x <- summary(x)\n  \n  # 获取Wald检验的p值并截断为两位小数\n  p.value <- signif(x$wald["pvalue"], digits = 2)\n  \n  # 获取模型系数的估计值（通常表示风险比HR）并截断为两位小数\n  HR <- signif(x$coef[2], digits = 2)\n  \n  # 获取HR的95%置信区间的下界和上界并截断为两位小数\n  HR.confint.lower <- signif(x$conf.int[,"lower .95"], digits = 2)\n  HR.confint.upper <- signif(x$conf.int[,"upper .95"], digits = 2)\n  \n  # 构建HR和其95%置信区间的字符串表示\n  HR <- paste0(HR, " (", HR.confint.lower, "-", HR.confint.upper, ")")\n\n  res <- c(p.value, HR) # 创建一个包含p值和HR（以及其95%置信区间）的结果向量\n\n  names(res) <- c("p.value", "HR (95% CI)") # 设置结果向量的名称，便于后续引用\n  \n  return(res)  # 返回结果向量\n})\n\nres_uni_cox <- as.data.frame(t(as.data.frame(uni_results, check.names = FALSE)))\nres_uni_cox\n\n\n\n### 多因素cox回归分析\nmul_cox <- coxph(Surv(Time, Status) ~ Age + IDH_status + MGMT_promoter_status + Stage, data = tcga_gbmlgg_cli)\nsummary(mul_cox)\n\nx <- summary(mul_cox)\npvalue <- signif(as.matrix(x$coefficients)[ , 5], 2)\nHR <- signif(as.matrix(x$coefficients)[ , 2], 2)\nlow <- signif(x$conf.int[ , 3], 2)\nhigh <- signif(x$conf.int[ , 4], 2)\n\nres_mul_cox <- data.frame(p.value = pvalue, HR = paste0(HR, " (", low, "-", high, ")", sep = ""), stringsAsFactors = F)\nres_mul_cox\n\n### 展示结果\npdf("./cox_data/forest_plot.pdf", width = 8, height = 8)\nggforest(mul_cox, data = tcga_gbmlgg_cli)\ndev.off()\n')])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br"),s("span",{staticClass:"line-number"},[a._v("13")]),s("br"),s("span",{staticClass:"line-number"},[a._v("14")]),s("br"),s("span",{staticClass:"line-number"},[a._v("15")]),s("br"),s("span",{staticClass:"line-number"},[a._v("16")]),s("br"),s("span",{staticClass:"line-number"},[a._v("17")]),s("br"),s("span",{staticClass:"line-number"},[a._v("18")]),s("br"),s("span",{staticClass:"line-number"},[a._v("19")]),s("br"),s("span",{staticClass:"line-number"},[a._v("20")]),s("br"),s("span",{staticClass:"line-number"},[a._v("21")]),s("br"),s("span",{staticClass:"line-number"},[a._v("22")]),s("br"),s("span",{staticClass:"line-number"},[a._v("23")]),s("br"),s("span",{staticClass:"line-number"},[a._v("24")]),s("br"),s("span",{staticClass:"line-number"},[a._v("25")]),s("br"),s("span",{staticClass:"line-number"},[a._v("26")]),s("br"),s("span",{staticClass:"line-number"},[a._v("27")]),s("br"),s("span",{staticClass:"line-number"},[a._v("28")]),s("br"),s("span",{staticClass:"line-number"},[a._v("29")]),s("br"),s("span",{staticClass:"line-number"},[a._v("30")]),s("br"),s("span",{staticClass:"line-number"},[a._v("31")]),s("br"),s("span",{staticClass:"line-number"},[a._v("32")]),s("br"),s("span",{staticClass:"line-number"},[a._v("33")]),s("br"),s("span",{staticClass:"line-number"},[a._v("34")]),s("br"),s("span",{staticClass:"line-number"},[a._v("35")]),s("br"),s("span",{staticClass:"line-number"},[a._v("36")]),s("br"),s("span",{staticClass:"line-number"},[a._v("37")]),s("br"),s("span",{staticClass:"line-number"},[a._v("38")]),s("br"),s("span",{staticClass:"line-number"},[a._v("39")]),s("br"),s("span",{staticClass:"line-number"},[a._v("40")]),s("br"),s("span",{staticClass:"line-number"},[a._v("41")]),s("br"),s("span",{staticClass:"line-number"},[a._v("42")]),s("br"),s("span",{staticClass:"line-number"},[a._v("43")]),s("br"),s("span",{staticClass:"line-number"},[a._v("44")]),s("br"),s("span",{staticClass:"line-number"},[a._v("45")]),s("br"),s("span",{staticClass:"line-number"},[a._v("46")]),s("br"),s("span",{staticClass:"line-number"},[a._v("47")]),s("br"),s("span",{staticClass:"line-number"},[a._v("48")]),s("br"),s("span",{staticClass:"line-number"},[a._v("49")]),s("br"),s("span",{staticClass:"line-number"},[a._v("50")]),s("br"),s("span",{staticClass:"line-number"},[a._v("51")]),s("br"),s("span",{staticClass:"line-number"},[a._v("52")]),s("br"),s("span",{staticClass:"line-number"},[a._v("53")]),s("br"),s("span",{staticClass:"line-number"},[a._v("54")]),s("br"),s("span",{staticClass:"line-number"},[a._v("55")]),s("br"),s("span",{staticClass:"line-number"},[a._v("56")]),s("br"),s("span",{staticClass:"line-number"},[a._v("57")]),s("br"),s("span",{staticClass:"line-number"},[a._v("58")]),s("br"),s("span",{staticClass:"line-number"},[a._v("59")]),s("br"),s("span",{staticClass:"line-number"},[a._v("60")]),s("br"),s("span",{staticClass:"line-number"},[a._v("61")]),s("br"),s("span",{staticClass:"line-number"},[a._v("62")]),s("br"),s("span",{staticClass:"line-number"},[a._v("63")]),s("br"),s("span",{staticClass:"line-number"},[a._v("64")]),s("br"),s("span",{staticClass:"line-number"},[a._v("65")]),s("br"),s("span",{staticClass:"line-number"},[a._v("66")]),s("br"),s("span",{staticClass:"line-number"},[a._v("67")]),s("br"),s("span",{staticClass:"line-number"},[a._v("68")]),s("br"),s("span",{staticClass:"line-number"},[a._v("69")]),s("br"),s("span",{staticClass:"line-number"},[a._v("70")]),s("br"),s("span",{staticClass:"line-number"},[a._v("71")]),s("br"),s("span",{staticClass:"line-number"},[a._v("72")]),s("br"),s("span",{staticClass:"line-number"},[a._v("73")]),s("br"),s("span",{staticClass:"line-number"},[a._v("74")]),s("br"),s("span",{staticClass:"line-number"},[a._v("75")]),s("br"),s("span",{staticClass:"line-number"},[a._v("76")]),s("br"),s("span",{staticClass:"line-number"},[a._v("77")]),s("br"),s("span",{staticClass:"line-number"},[a._v("78")]),s("br"),s("span",{staticClass:"line-number"},[a._v("79")]),s("br"),s("span",{staticClass:"line-number"},[a._v("80")]),s("br"),s("span",{staticClass:"line-number"},[a._v("81")]),s("br"),s("span",{staticClass:"line-number"},[a._v("82")]),s("br"),s("span",{staticClass:"line-number"},[a._v("83")]),s("br"),s("span",{staticClass:"line-number"},[a._v("84")]),s("br"),s("span",{staticClass:"line-number"},[a._v("85")]),s("br")])]),s("h2",{attrs:{id:"统计分析-logistic"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#统计分析-logistic"}},[a._v("#")]),a._v(" 统计分析/Logistic")]),a._v(" "),s("p",[a._v("可能参考的资料：")]),a._v(" "),s("p",[s("a",{attrs:{href:"https://bchobby.github.io/posts/7530c0eb90ba987abed63344c71a3995/",target:"_blank",rel:"noopener noreferrer"}},[a._v("【R语言】logistic回归（二）多因素logistic回归 - 编程爱好者博客 (bchobby.github.io)"),s("OutboundLink")],1)]),a._v(" "),s("p",[s("a",{attrs:{href:"https://blog.csdn.net/qq_42696043/article/details/125306843",target:"_blank",rel:"noopener noreferrer"}},[a._v("【R语言】logistic回归（二）多因素logistic回归_r语言多因素logistic回归-CSDN博客"),s("OutboundLink")],1)]),a._v(" "),s("h2",{attrs:{id:"统计分析-lasso"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#统计分析-lasso"}},[a._v("#")]),a._v(" 统计分析/LASSO")]),a._v(" "),s("p",[a._v("同一个作者的分享，非常棒！")]),a._v(" "),s("p",[s("a",{attrs:{href:"https://mp.weixin.qq.com/s/kSrr6regfAtX4Bw6gSvmgw",target:"_blank",rel:"noopener noreferrer"}},[a._v("基于 LASSO 回归筛选变量以构建预测模型 | 附完整代码 + 注释 (qq.com)"),s("OutboundLink")],1)]),a._v(" "),s("p",[a._v("Lasso回归（Least Absolute Shrinkage and Selection Operator）是一种用于线性回归问题的正则化方法，它可以用来降低模型的复杂性，防止过拟合，并选择重要的特征变量。")]),a._v(" "),s("p",[a._v("一些基本的，重要的概念：")]),a._v(" "),s("ul",[s("li",[a._v("正则化（Regularization）是一种在机器学习和统计建模中常用的技术，旨在帮助模型更好地泛化到未见过的数据，避免过拟合问题。")]),a._v(" "),s("li",[a._v("过拟合（overfitting）是指模型在训练数据上表现得非常好，但在未见过的测试数据上表现较差的情况。")])]),a._v(" "),s("p",[a._v("三种正则化的方式：")]),a._v(" "),s("ul",[s("li",[a._v("LASSO回归，减少特征选择，只要最重要的几个特征（适合寻找确定只有几个因素影响结果的因素）")]),a._v(" "),s("li",[a._v("岭回归，减弱特征选择，保留着，但是权重会调整（适合综合全面考虑若干对结果都有影响的因素）")]),a._v(" "),s("li",[a._v("弹性回归，综合考虑了前面两个回归的有点，想要筛掉一些特征，又想保留一些特征的时候适合")])]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('数据格式：行名为患者信息，前两列为OS，OS.time，之后就是对生存时间的影响因素\n\nx <- as.matrix(lasso_data[ , c(3:ncol(lasso_data))])  \ny <- as.matrix(Surv(lasso_data$OS.time, lasso_data$OS))\n\nalpha1_fit <- glmnet(x, y, alpha = 1, family = "cox", nlambda = 100)\nplot(alpha1_fit, xvar = "lambda", label = TRUE) # 回归系数路径图\n\nalpha1.fit.cv <- cv.glmnet(x, y, type.measure = "deviance", alpha = 1, family = "cox") # 交叉验证\nplot(alpha1.fit.cv) # 交叉验证曲线\n\nprint(alpha1.fit.cv) # 打印结果\n\ncoef(alpha1.fit.cv, s = alpha1.fit.cv$lambda.1se)\n\n# 特征提取\nfeature_all <- as.data.frame(as.matrix(coef(alpha1.fit.cv, s = alpha1.fit.cv$lambda.1se)))  \ncolnames(feature_all) <- "coff"  \nfeature_opt <-  feature_all %>% filter(abs(coff) > 0)  \nrownames(feature_opt)\n')])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br"),s("span",{staticClass:"line-number"},[a._v("13")]),s("br"),s("span",{staticClass:"line-number"},[a._v("14")]),s("br"),s("span",{staticClass:"line-number"},[a._v("15")]),s("br"),s("span",{staticClass:"line-number"},[a._v("16")]),s("br"),s("span",{staticClass:"line-number"},[a._v("17")]),s("br"),s("span",{staticClass:"line-number"},[a._v("18")]),s("br"),s("span",{staticClass:"line-number"},[a._v("19")]),s("br"),s("span",{staticClass:"line-number"},[a._v("20")]),s("br")])]),s("p",[a._v("感受：这个LASSO分析，主要是用来进一步筛选“危险因素”的统计分析，之后可以进一步COX回归分析之类的。")]),a._v(" "),s("p",[a._v("还可以的分析包括：列线图，生存分析，风险因子（这个作者说是三联图）")]),a._v(" "),s("h2",{attrs:{id:"统计分析-nomogram-calibration"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#统计分析-nomogram-calibration"}},[a._v("#")]),a._v(" 统计分析/Nomogram+Calibration")]),a._v(" "),s("p",[s("a",{attrs:{href:"https://mp.weixin.qq.com/s/xW4c1Ye8twsHCd_1eyFOWQ",target:"_blank",rel:"noopener noreferrer"}},[a._v("R语言绘图 | 列线图/诺莫图（Nomogram）和校准曲线（Calibration）| 代码注释 + 结果解读 (qq.com)"),s("OutboundLink")],1)]),a._v(" "),s("p",[a._v("一种可视化Logistic或Cox分析结果的方式 -- 列线图（Alignment Diagram），也称诺莫图（Nomogram）")])])}),[],!1,null,null,null);s.default=t.exports}}]);