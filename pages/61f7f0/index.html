<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>临床相关性 | 一盏烛光的微笑灿烂人生</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="https://at.alicdn.com/t/font_3129839_xft6cqs5gc.css">
    <noscript><meta http-equiv="refresh" content="0; url=https://www.youngkbt.cn/noscript/"><style>.theme-vdoing-content { display:none }</noscript>
    <meta name="description" content="学习记录博客">
    <meta name="theme-color" content="#11a8cd">
    <meta name="个人博客" content="科研学习，围炉夜话，奇淫巧计">
    
    <link rel="preload" href="/assets/css/0.styles.c9ffc21e.css" as="style"><link rel="preload" href="/assets/js/app.bd488e07.js" as="script"><link rel="preload" href="/assets/js/2.bdf5b8cf.js" as="script"><link rel="preload" href="/assets/js/49.05223958.js" as="script"><link rel="preload" href="/assets/js/3.365ac406.js" as="script"><link rel="prefetch" href="/assets/js/10.b00b53b4.js"><link rel="prefetch" href="/assets/js/100.1b2ba6dd.js"><link rel="prefetch" href="/assets/js/101.e392eb92.js"><link rel="prefetch" href="/assets/js/102.eb0bb162.js"><link rel="prefetch" href="/assets/js/103.9db14406.js"><link rel="prefetch" href="/assets/js/104.6ae6fd5c.js"><link rel="prefetch" href="/assets/js/105.4d79399b.js"><link rel="prefetch" href="/assets/js/106.4e6ff12d.js"><link rel="prefetch" href="/assets/js/107.bc93ee73.js"><link rel="prefetch" href="/assets/js/108.59a000f0.js"><link rel="prefetch" href="/assets/js/109.f01f4422.js"><link rel="prefetch" href="/assets/js/11.346d31c6.js"><link rel="prefetch" href="/assets/js/110.96a96c44.js"><link rel="prefetch" href="/assets/js/111.87fe63df.js"><link rel="prefetch" href="/assets/js/112.c560a316.js"><link rel="prefetch" href="/assets/js/113.6a371b02.js"><link rel="prefetch" href="/assets/js/114.989a4d3e.js"><link rel="prefetch" href="/assets/js/115.b6baafa2.js"><link rel="prefetch" href="/assets/js/116.d469dc20.js"><link rel="prefetch" href="/assets/js/117.0a6bccf0.js"><link rel="prefetch" href="/assets/js/118.9f1ef088.js"><link rel="prefetch" href="/assets/js/119.059ef806.js"><link rel="prefetch" href="/assets/js/12.8d91a638.js"><link rel="prefetch" href="/assets/js/120.75ed11ab.js"><link rel="prefetch" href="/assets/js/121.1896ee22.js"><link rel="prefetch" href="/assets/js/122.a3664290.js"><link rel="prefetch" href="/assets/js/123.5b849c39.js"><link rel="prefetch" href="/assets/js/124.85737d6b.js"><link rel="prefetch" href="/assets/js/125.a95cd42f.js"><link rel="prefetch" href="/assets/js/126.7b1c1645.js"><link rel="prefetch" href="/assets/js/127.64a16fd4.js"><link rel="prefetch" href="/assets/js/128.a07721ba.js"><link rel="prefetch" href="/assets/js/129.9ba86871.js"><link rel="prefetch" href="/assets/js/13.18ed2aa7.js"><link rel="prefetch" href="/assets/js/130.5cdb8138.js"><link rel="prefetch" href="/assets/js/131.d2f31425.js"><link rel="prefetch" href="/assets/js/132.b2286d65.js"><link rel="prefetch" href="/assets/js/133.1229c9ae.js"><link rel="prefetch" href="/assets/js/134.71fad9a0.js"><link rel="prefetch" href="/assets/js/135.ff682301.js"><link rel="prefetch" href="/assets/js/136.9de1870b.js"><link rel="prefetch" href="/assets/js/137.a58bbdcd.js"><link rel="prefetch" href="/assets/js/138.cc768cb1.js"><link rel="prefetch" href="/assets/js/139.9d52d34a.js"><link rel="prefetch" href="/assets/js/14.4bcf7ee9.js"><link rel="prefetch" href="/assets/js/140.b1790e58.js"><link rel="prefetch" href="/assets/js/141.98bceb9f.js"><link rel="prefetch" href="/assets/js/142.0415d712.js"><link rel="prefetch" href="/assets/js/143.851c7187.js"><link rel="prefetch" href="/assets/js/144.ae79e007.js"><link rel="prefetch" href="/assets/js/145.d5020e58.js"><link rel="prefetch" href="/assets/js/146.c3eafa98.js"><link rel="prefetch" href="/assets/js/147.0a6864ec.js"><link rel="prefetch" href="/assets/js/148.bbc4bd28.js"><link rel="prefetch" href="/assets/js/149.489e8cdb.js"><link rel="prefetch" href="/assets/js/15.368d9d2d.js"><link rel="prefetch" href="/assets/js/150.7778d444.js"><link rel="prefetch" href="/assets/js/16.06f68354.js"><link rel="prefetch" href="/assets/js/17.4f8d6256.js"><link rel="prefetch" href="/assets/js/18.8989b2ff.js"><link rel="prefetch" href="/assets/js/19.abb857ca.js"><link rel="prefetch" href="/assets/js/20.e32420cf.js"><link rel="prefetch" href="/assets/js/21.06441c4d.js"><link rel="prefetch" href="/assets/js/22.7fb78c64.js"><link rel="prefetch" href="/assets/js/23.d9193b83.js"><link rel="prefetch" href="/assets/js/24.6487f43a.js"><link rel="prefetch" href="/assets/js/25.11e66938.js"><link rel="prefetch" href="/assets/js/26.c3e43726.js"><link rel="prefetch" href="/assets/js/27.24117748.js"><link rel="prefetch" href="/assets/js/28.fabf32c7.js"><link rel="prefetch" href="/assets/js/29.3a9331f2.js"><link rel="prefetch" href="/assets/js/30.ac5ca451.js"><link rel="prefetch" href="/assets/js/31.36e6c9c0.js"><link rel="prefetch" href="/assets/js/32.2fcf84e2.js"><link rel="prefetch" href="/assets/js/33.a73adf6b.js"><link rel="prefetch" href="/assets/js/34.49c0fb46.js"><link rel="prefetch" href="/assets/js/35.babda623.js"><link rel="prefetch" href="/assets/js/36.56221bac.js"><link rel="prefetch" href="/assets/js/37.5d6d33aa.js"><link rel="prefetch" href="/assets/js/38.a6b592e0.js"><link rel="prefetch" href="/assets/js/39.14a81539.js"><link rel="prefetch" href="/assets/js/4.a64d5c9f.js"><link rel="prefetch" href="/assets/js/40.e94616b3.js"><link rel="prefetch" href="/assets/js/41.4ad9febc.js"><link rel="prefetch" href="/assets/js/42.4825ff11.js"><link rel="prefetch" href="/assets/js/43.6d554f8a.js"><link rel="prefetch" href="/assets/js/44.ed8f011b.js"><link rel="prefetch" href="/assets/js/45.170e103d.js"><link rel="prefetch" href="/assets/js/46.9cc703a7.js"><link rel="prefetch" href="/assets/js/47.ff6af7ea.js"><link rel="prefetch" href="/assets/js/48.1b2f1a1b.js"><link rel="prefetch" href="/assets/js/5.b1fd9f62.js"><link rel="prefetch" href="/assets/js/50.26aa9f07.js"><link rel="prefetch" href="/assets/js/51.65eba0cc.js"><link rel="prefetch" href="/assets/js/52.5b21c37d.js"><link rel="prefetch" href="/assets/js/53.4f209254.js"><link rel="prefetch" href="/assets/js/54.176923ed.js"><link rel="prefetch" href="/assets/js/55.74f6741d.js"><link rel="prefetch" href="/assets/js/56.383e3c0d.js"><link rel="prefetch" href="/assets/js/57.35b21350.js"><link rel="prefetch" href="/assets/js/58.7ae8fd30.js"><link rel="prefetch" href="/assets/js/59.3d7d7dea.js"><link rel="prefetch" href="/assets/js/6.993d7ad0.js"><link rel="prefetch" href="/assets/js/60.67ba2844.js"><link rel="prefetch" href="/assets/js/61.6c5542cd.js"><link rel="prefetch" href="/assets/js/62.a235dad7.js"><link rel="prefetch" href="/assets/js/63.a3a52fe2.js"><link rel="prefetch" href="/assets/js/64.2b6b610e.js"><link rel="prefetch" href="/assets/js/65.8672534a.js"><link rel="prefetch" href="/assets/js/66.c7281353.js"><link rel="prefetch" href="/assets/js/67.e062f6ac.js"><link rel="prefetch" href="/assets/js/68.446f0688.js"><link rel="prefetch" href="/assets/js/69.f03843ed.js"><link rel="prefetch" href="/assets/js/7.afb33a4c.js"><link rel="prefetch" href="/assets/js/70.466d842a.js"><link rel="prefetch" href="/assets/js/71.87fcb26b.js"><link rel="prefetch" href="/assets/js/72.ccf1092d.js"><link rel="prefetch" href="/assets/js/73.3ad6124b.js"><link rel="prefetch" href="/assets/js/74.17a59372.js"><link rel="prefetch" href="/assets/js/75.6c859470.js"><link rel="prefetch" href="/assets/js/76.674a56ad.js"><link rel="prefetch" href="/assets/js/77.5342f3c1.js"><link rel="prefetch" href="/assets/js/78.154ba5e1.js"><link rel="prefetch" href="/assets/js/79.10901b1c.js"><link rel="prefetch" href="/assets/js/8.5bbd7ae9.js"><link rel="prefetch" href="/assets/js/80.0166104e.js"><link rel="prefetch" href="/assets/js/81.4c5a0e6a.js"><link rel="prefetch" href="/assets/js/82.47099701.js"><link rel="prefetch" href="/assets/js/83.7873cd95.js"><link rel="prefetch" href="/assets/js/84.23000f66.js"><link rel="prefetch" href="/assets/js/85.6701c9e4.js"><link rel="prefetch" href="/assets/js/86.188012c3.js"><link rel="prefetch" href="/assets/js/87.e9cde64e.js"><link rel="prefetch" href="/assets/js/88.5ccdea49.js"><link rel="prefetch" href="/assets/js/89.9ab559de.js"><link rel="prefetch" href="/assets/js/9.6699859e.js"><link rel="prefetch" href="/assets/js/90.bc7fb61d.js"><link rel="prefetch" href="/assets/js/91.07537d0a.js"><link rel="prefetch" href="/assets/js/92.b4ed0bad.js"><link rel="prefetch" href="/assets/js/93.b167c2d0.js"><link rel="prefetch" href="/assets/js/94.1a02653c.js"><link rel="prefetch" href="/assets/js/95.69ef19be.js"><link rel="prefetch" href="/assets/js/96.e0b3f5df.js"><link rel="prefetch" href="/assets/js/97.9ea0c268.js"><link rel="prefetch" href="/assets/js/98.074852d9.js"><link rel="prefetch" href="/assets/js/99.708b118b.js">
    <link rel="stylesheet" href="/assets/css/0.styles.c9ffc21e.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.png" alt="一盏烛光的微笑灿烂人生" class="logo"> <span class="site-name can-hide">一盏烛光的微笑灿烂人生</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="科研学习" class="dropdown-title"><a href="/study/" class="link-title">科研学习</a> <span class="title" style="display:none;">科研学习</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/articles/" class="nav-link">阅读记录</a></li><li class="dropdown-item"><!----> <a href="/biotech/" class="nav-link">生信分析</a></li><li class="dropdown-item"><!----> <a href="/basic/" class="nav-link">整理归纳</a></li></ul></div></div><div class="nav-item"><a href="/wlyh/" class="nav-link">围炉夜话</a></div><div class="nav-item"><a href="/technology/" class="nav-link">奇淫巧计</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/about/" class="nav-link">关于</a></li><li class="dropdown-item"><!----> <a href="/links/" class="nav-link">一些网站</a></li><li class="dropdown-item"><!----> <a href="/friends/" class="nav-link">友情链接</a></li><li class="dropdown-item"><!----> <a href="/passbyworld/" class="nav-link">路过人间</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="https://pica.zhimg.com/v2-f2b30ad5674f652294f0ec6f9b8c9922_720w.webp?source=d16d100b"> <div class="blogger-info"><h3>围炉夜话</h3> <span>知行合一</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="科研学习" class="dropdown-title"><a href="/study/" class="link-title">科研学习</a> <span class="title" style="display:none;">科研学习</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/articles/" class="nav-link">阅读记录</a></li><li class="dropdown-item"><!----> <a href="/biotech/" class="nav-link">生信分析</a></li><li class="dropdown-item"><!----> <a href="/basic/" class="nav-link">整理归纳</a></li></ul></div></div><div class="nav-item"><a href="/wlyh/" class="nav-link">围炉夜话</a></div><div class="nav-item"><a href="/technology/" class="nav-link">奇淫巧计</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/about/" class="nav-link">关于</a></li><li class="dropdown-item"><!----> <a href="/links/" class="nav-link">一些网站</a></li><li class="dropdown-item"><!----> <a href="/friends/" class="nav-link">友情链接</a></li><li class="dropdown-item"><!----> <a href="/passbyworld/" class="nav-link">路过人间</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>阅读记录</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>生信分析</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/9fc671/" class="sidebar-link">生信分析</a></li><li><a href="/pages/902bc2/" class="sidebar-link">转录组</a></li><li><a href="/pages/aebaf3/" class="sidebar-link">表观组</a></li><li><a href="/pages/819cd3/" class="sidebar-link">单细胞-概览</a></li><li><a href="/pages/c81394/" class="sidebar-link">单细胞-ATAC</a></li><li><a href="/pages/9033c2/" class="sidebar-link">单细胞-细胞注释</a></li><li><a href="/pages/e0b862/" class="sidebar-link">单细胞-异质性</a></li><li><a href="/pages/1cd666/" class="sidebar-link">Linux</a></li><li><a href="/pages/a8bb10/" class="sidebar-link">R</a></li><li><a href="/pages/d630fc/" class="sidebar-link">python</a></li><li><a href="/pages/73836e/" class="sidebar-link">基因注释</a></li><li><a href="/pages/49f65b/" class="sidebar-link">富集分析</a></li><li><a href="/pages/61f7f0/" aria-current="page" class="active sidebar-link">临床相关性</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/61f7f0/#线上分析网站" class="sidebar-link">线上分析网站</a></li><li class="sidebar-sub-header level2"><a href="/pages/61f7f0/#数据来源" class="sidebar-link">数据来源</a></li><li class="sidebar-sub-header level2"><a href="/pages/61f7f0/#生存分析基本概念" class="sidebar-link">生存分析基本概念</a></li><li class="sidebar-sub-header level2"><a href="/pages/61f7f0/#实现survival" class="sidebar-link">实现Survival</a></li><li class="sidebar-sub-header level2"><a href="/pages/61f7f0/#统计分析-cox" class="sidebar-link">统计分析/Cox</a></li><li class="sidebar-sub-header level2"><a href="/pages/61f7f0/#统计分析-logistic" class="sidebar-link">统计分析/Logistic</a></li><li class="sidebar-sub-header level2"><a href="/pages/61f7f0/#统计分析-lasso" class="sidebar-link">统计分析/LASSO</a></li><li class="sidebar-sub-header level2"><a href="/pages/61f7f0/#统计分析-nomogram-calibration" class="sidebar-link">统计分析/Nomogram+Calibration</a></li></ul></li><li><a href="/pages/28c669/" class="sidebar-link">WGCNA</a></li><li><a href="/pages/69a308/" class="sidebar-link">Seurat</a></li><li><a href="/pages/784c69/" class="sidebar-link">Scanpy</a></li><li><a href="/pages/44ad24/" class="sidebar-link">Monocle2</a></li><li><a href="/pages/893dcf/" class="sidebar-link">单细胞-轨迹分析</a></li><li><a href="/pages/7989c6/" class="sidebar-link">CellPhoneDB</a></li><li><a href="/pages/dbe3de/" class="sidebar-link">CellChat2</a></li><li><a href="/pages/df4df8/" class="sidebar-link">NicheNet</a></li><li><a href="/pages/5f4d84/" class="sidebar-link">SCENIC</a></li><li><a href="/pages/9f91d0/" class="sidebar-link">单细胞-RNA velocity</a></li><li><a href="/pages/d079f5/" class="sidebar-link">细胞外囊泡</a></li><li><a href="/pages/d7b340/" class="sidebar-link">数据分析和数据挖掘</a></li><li><a href="/pages/c7d198/" class="sidebar-link">数据处理</a></li><li><a href="/pages/e50bac/" class="sidebar-link">data.frame</a></li><li><a href="/pages/500bc4/" class="sidebar-link">ggplot2</a></li><li><a href="/pages/937699/" class="sidebar-link">数据可视化-Python</a></li><li><a href="/pages/6cbee5/" class="sidebar-link">绘图</a></li><li><a href="/pages/5666ad/" class="sidebar-link">统计</a></li><li><a href="/pages/e75428/" class="sidebar-link">想法和借鉴</a></li><li><a href="/pages/7f8ebe/" class="sidebar-link">Algorithm</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>实验技术</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>整理归纳</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/study/#科研学习" data-v-06225672>科研学习</a></li><li data-v-06225672><a href="/study/#生信分析" data-v-06225672>生信分析</a></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="javascript:;" data-v-06225672>FHL</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2023-12-01</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABKFJREFUSA3tVl1oFVcQnrMbrak3QUgkya1akpJYcrUtIqW1JvFBE9LiQ5v6JmJpolbMg32rVrhgoYK0QiMY6i9Y6EMaW5D+xFJaTYItIuK2Kr3+BJNwkxBj05sQY3b3nM6cs2dv9t7NT/vQJw/sndk5M/PNzJkzewGerP+pAmy+ON8lLzUJgA8ZYxYIYZmGYRnctDaWvJJAmTtfP1pvXsBCCPP8QFcCaRkZYACgDZFO4stNIcBCajEOlmmC9XpJ9bAGCaPaPmzPl32dvLSVu3BWCTQs0XQQ6g0DYgwLIoAZbBCdW/i+781o1VVlm/410mw4h06Y7bIPHNyWDyL4FHkX03Q8SrzNhZTZriieckWt7cL6MM85YcLpsi/7O9/iXFT6MswI0DmmpkSaJ0qLxFIm3+i1THHB3zmBH3PYx9CcykcLOeQVVa7QtdxTgQgEleX2AjHYfwA+2ddV77ruGoJUbhGDI09YSNXyMpUt5ylOzxgbUmtOp7NmbNt8v3arjTBfYELmLUV+M+nSawNNAUqpT3ClJWg5I3BLT+cGW/DXNGCa6tx1aakCGEigArTn4TDIPdrXXYKCZNrHLMCOEPvHBlLQ99s9eHB7EB6NTki73CVPQ2F5MSx/uRQixfmq7rK0wYD8w8E905bnPDfwoWs/rfv93NWN/ZfvwsLIU7A09gxECyISeGJkHAau98L97tuw7NXnoPyNF8FcYGLGKsOs0mN3OEyec9esGW/ZEl945dTP34wlR2FZVQWU1q0Cw8Tr7p+hgLLNL0FPxx/Q35mA8aEUrH6nCgwEl0tn7wUiZYJnNRh6DK4UH/k0lfyrsBKdPVv/AriGIQcEDQZ65LBAGe2Rzui9Ybjz7XUppz1/uKBbyVPGkN3ZAeC6hr0x7Nr38N5+EqkoOm17xpoqR9ohQF55ERSvr4Dkr3chNfC3DMzGJlNBElW8w9nsGQvhNGIzDkXzCg8cLK951xHsFBlTJspJNi3ZFIMF2AeDV3q8DNOB+YHi6QTrChDIWDBRi5U5f+ZMfJLu3ccrqxtdxk4SKH336LFxSmkqefwU5T8fhdSdQf9IVKD6aNiwI/hnmcAZ91isYMJIaCUCx9W098+LgruikeTqzqqxKPUwqJyCPJiyemVVZBOijDGjD38Os0jOiSPL1z3SPjXNANbiNPXAdzTfukjjuknNBbyz3nwgTd3AVFqUJ5hpHlq9MveLnWwttUfoygBmvVjuikxND3znrhsELnZk7k+OjIGxeNEkomyLVta0xxn+HZhjBc4YZ/AFjHjz9u3xRZl2BN4aq9nFwWh16IrQ1aHHEd3j1+4/dB9OtH4e29A2H1DyHQRmOSfQZ1Fy7MHBTGB6J/Djq6p3OxyO2cB+4Car7v/o3GXgfAkj23+x9ID1Teoamo/SXcbvSf2PX7Vc8DdCmE1vN9di+32P9/5YR3vLnhCVGUWBjEkr3yh4H8v9CzmsbdhzOKzsJKM90iFdaTMjRPhGVsakRvOaRidljo6H6G7j+ctrJpsP+4COhDIl0La2+FS4+5mlocBaXY5QnGZysIBYoeSsl5qQzrSj/cgNrfuEzlWBfwA+EjrZyWUvpAAAAABJRU5ErkJggg==">临床相关性<!----></h1>  <div class="theme-vdoing-content content__default"><p>有一些简单易行的生存分析资源，为何不白嫖一下试一试呢？</p> <h2 id="线上分析网站"><a href="#线上分析网站" class="header-anchor">#</a> 线上分析网站</h2> <p><a href="https://www.jianshu.com/p/1501dbb94ccd" target="_blank" rel="noopener noreferrer">三大经典在线生存分析工具测评 - 简书 (jianshu.com)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>GEPIA2：<a href="http://gepia2.cancer-pku.cn/#index" target="_blank" rel="noopener noreferrer">GEPIA 2 (cancer-pku.cn)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <blockquote><p>出图快，可以简单尝试一下，颜色可调，但是截距，Cutoff等等数据分类方式不能调整</p></blockquote> <p>Kaplan-Meier Plotter：<a href="https://kmplot.com/analysis/" target="_blank" rel="noopener noreferrer">Kaplan-Meier plotter (kmplot.com)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <blockquote><p>速度很快，但是配色不可以调，数据不便调整</p></blockquote> <p>OncoLnc：<a href="http://www.oncolnc.org/" target="_blank" rel="noopener noreferrer">OncoLnc<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <blockquote><p>数据多，可导出原始数据，还可以适当调整数据分类方式</p></blockquote> <p>如果想要自己分析，数据可以从哪里白嫖一下嘞？</p> <h2 id="数据来源"><a href="#数据来源" class="header-anchor">#</a> 数据来源</h2> <p>oncoPredict: an R package for predicting in vivo or cancer patient drug response and biomarkers from cell line screening data</p> <p><a href="https://www.cancer.gov/ccg/research/genome-sequencing/tcga" target="_blank" rel="noopener noreferrer">The Cancer Genome Atlas Program (TCGA) - NCI<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://portal.gdc.cancer.gov/" target="_blank" rel="noopener noreferrer">GDC (cancer.gov)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://xenabrowser.net/datapages/" target="_blank" rel="noopener noreferrer">UCSC Xena (xenabrowser.net)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://mp.weixin.qq.com/s/S7s6topP0SfRAZ8YCHy7yQ" target="_blank" rel="noopener noreferrer">新版TCGA数据分析实战——数据下载与整理 (qq.com)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://mp.weixin.qq.com/s/_xVOBTJ0DkpxiIj03NY6TQ" target="_blank" rel="noopener noreferrer">（小白）看完还不会来揍/找我 | TCGA 与 GTEx 数据库联合分析 | 附完整代码 + 注释 (qq.com)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://mp.weixin.qq.com/s/8Q7Rb7K-Mrs_fA5c5OvyqA" target="_blank" rel="noopener noreferrer">（小白）TCGA 样本命名规则详解 | 快速获取样本类型、组织来源等分组信息 (qq.com)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://mp.weixin.qq.com/s/pv49e-lf9ZnEAmSiQIflIQ" target="_blank" rel="noopener noreferrer">（小白）看完还不会来揍/找我 | 差异分析三巨头 —— DESeq2、edgeR 和 limma 包 | 附完整代码 + 注释 (qq.com)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>读取和处理</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>fread(&quot;./data/TCGA-BRCA.htseq_counts.tsv.gz&quot;, header = T, sep = '\t', data.table = F)

fread(&quot;./data/gencode.v22.annotation.gene.probeMap&quot;, header = T, sep = '\t', data.table = F)

merge(gene_id, exp_brca, by.x = &quot;id&quot;, by.y  = &quot;Ensembl_ID&quot;) # 合并

distinct(exp_brca, gene, .keep_all = T) # 去重

substring(colnames(exp_brca), 14, 15)

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>分分类，准备画个火山图</p> <div class="language- line-numbers-mode"><pre class="language-text"><code># 分类判断
logFC = 2.5  
P.Value = 0.01  
k1 &lt;- (DEG_deseq2$pvalue &lt; P.Value) &amp; (DEG_deseq2$log2FoldChange &lt; -logFC)
k2 &lt;- (DEG_deseq2$pvalue &lt; P.Value) &amp; (DEG_deseq2$log2FoldChange &gt; logFC)
DEG_deseq2 &lt;- mutate(DEG_deseq2, change = ifelse(k1, &quot;down&quot;, ifelse(k2, &quot;up&quot;, &quot;stable&quot;)))  
table(DEG_deseq2$change)


# 火山图
p &lt;- ggplot(data = DEG_deseq2,   
            aes(x = log2FoldChange,   
                y = -log10(pvalue))) +  
  geom_point(alpha = 0.4, size = 3.5,   
             aes(color = change)) +  
  ylab(&quot;-log10(Pvalue)&quot;)+  
  scale_color_manual(values = c(&quot;blue4&quot;, &quot;grey&quot;, &quot;red3&quot;))+  
  geom_vline(xintercept = c(-logFC, logFC), lty = 4, col = &quot;black&quot;, lwd = 0.8) +  
  geom_hline(yintercept = -log10(P.Value), lty = 4, col = &quot;black&quot;, lwd = 0.8) +  
  theme_bw()  
p

# 热图
deg_opt &lt;- DEG_deseq2 %&gt;% filter(DEG_deseq2$change != &quot;stable&quot;)  
exp_brca_heatmap &lt;- exp_brca %&gt;% filter(rownames(exp_brca) %in% rownames(deg_opt))  
annotation_col &lt;- data.frame(group = group)  
rownames(annotation_col) &lt;- colnames(exp_brca_heatmap)   
  
p1 &lt;- pheatmap(exp_brca_heatmap, show_colnames = F, show_rownames = F,  
               scale = &quot;row&quot;,  
               cluster_cols = F,  
               annotation_col = annotation_col,  
               breaks = seq(-3, 3, length.out = 100))   
p1


# 保存图片
ggsave(filename = &quot;./figure/heatmap_plot_deseq2.pdf&quot;, plot = p1, device = &quot;pdf&quot;, width = 5, height = 6)  
dev.off()
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div><h2 id="生存分析基本概念"><a href="#生存分析基本概念" class="header-anchor">#</a> 生存分析基本概念</h2> <p><img src="https://s2.loli.net/2024/04/02/GvJtFCQbiBXE85c.png" alt="生存分析图示.png|400"></p> <p>生存分析是什么？</p> <ul><li>时间维度上，相关因素，对生存事件的影响情况</li></ul> <p>怎么做生存分析？（data，code）</p> <ul><li>数据类型是，时间-事件的资料，为什么是事件呢？因为生存不一定是指死亡，也可以是指无病生存期之类的，只要是我们研究感兴趣的终点事件就可以。截尾值censored value，研究对象，因为各种原因，不能提供后续数据。</li> <li>“死亡速度”，好像是看单位时间内的死亡速度有多快。产生“阳性事件”的快慢。</li></ul> <p>生存分析的一般内容：</p> <ol><li>描述生存过程，估计生存曲线 → 寿命表法，Kalplan-Meier法</li> <li>生存时间分布的组间比较 → Log rank检验，广义秩和检验</li> <li>评价影响因素 → Cox回归模型</li></ol> <p>研究开始到结束，这个时间段叫“生存时间”，两个时间点间，出现了“终点事件”以及其观察数据叫我完全数据，未出现“终点事件”中途退出的情况为删失数据。</p> <p>如何进行描述统计呢？</p> <ul><li>Kaplan-Meier估计方法：将参与人员按照参与时间的长短排序，逐个时间点计算生存率。</li></ul> <p>如何进行检验呢？</p> <ul><li>Log-rank检验，或Breslow检验，进行假设检验。</li></ul> <p>基础概念</p> <ul><li>survival analysis，生存分析</li> <li>event，终点事件</li> <li>survival time，起止时间间隔 / failure time，失效时间</li> <li>censoring，删失/截堵</li></ul> <p><strong>所以数据最重要的是，时间（横坐标），发生事件数量，可以算出比例（纵坐标）！</strong><br> <strong>再多加一列数据是其他因素（分开曲线），变成若干条生存曲线在一张图上，用Log-rank检验。</strong></p> <p>注意：样本量越大，曲线越平滑，误差越大，越容易出现统计学差异；随访时间越长，越容易出现统计学差异；生存曲线与X轴交叉，可能是研究对象全部发生终点事件，还有可能失访了；生存曲线下方最好标识分组的依据，样本量，易看，说服力强。</p> <p>详细介绍<a href="http://thisis.yorven.site/blog/index.php/2020/04/06/survival-analysis/" target="_blank" rel="noopener noreferrer">生存分析 简明教程 | Kaplan-Meier | Cox 比例风险回归模型<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>TCGA study abbreviations</p> <h2 id="实现survival"><a href="#实现survival" class="header-anchor">#</a> 实现Survival</h2> <p><a href="https://mp.weixin.qq.com/s/GSVFfEVT3V5BYQONp4Y1bQ" target="_blank" rel="noopener noreferrer">看完不会来揍我 | 生存分析详解 | 从基础概念到生存曲线绘制 | 代码注释 + 结果解读<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>实现的一种方式，其中最重要的就是<code>OS.time</code>，<code>OS</code>这一列时间，一列生存与否的信息</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>surdata&lt;-read.table(&quot;D:/Survival_inputdata.txt&quot;,sep=&quot;\t&quot;,header=TRUE) 
surdata&lt;-surdata[surdata$Group==&quot;GC&quot;,]

library(survival)
library(survminer)

part_data&lt;-na.omit(surdata[,c(2,4,5)])  ##colnames: &quot;mRNAsi, OS, OS.time&quot;

part_data &lt;- part_data %&gt;%
  dplyr::mutate(Type = case_when(
    CD44 &lt; mean(part_data[,1]) ~ 'low',
    CD44 &gt; mean(part_data[,1]) ~ 'high'
    ))

table(part_data$Type)
part_data &lt;- part_data[part_data$Type != &quot;Ns&quot;,]

res.cox &lt;- coxph(Surv(OS.time, OS) ~ Type, data = part_data)
res.cox

fit &lt;- survfit(Surv(OS.time, OS) ~ Type, data = part_data)
fit
summary(fit)

p &lt;- ggsurvplot(fit,
              # palette = c(&quot;#00599F&quot;,&quot;#d80700&quot;),
              # pval =TRUE,
              # conf.int =TRUE,xlab =&quot;Time&quot;,
              # surv.median.line = &quot;hv&quot;,
              #legend.title=&quot;标记&quot;,
              #legend.labs=c(&quot;CD44.H (n=219)&quot;,&quot;CD44.L (n=190)&quot;),
              #title=&quot;Overall Survival(OS)&quot;,
              )
p
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><h2 id="统计分析-cox"><a href="#统计分析-cox" class="header-anchor">#</a> 统计分析/Cox</h2> <p>下面这个教程真的很棒！</p> <p><a href="https://mp.weixin.qq.com/s/DrY69gY7cPE7OocFQ_8iVA" target="_blank" rel="noopener noreferrer">构建 Cox 比例风险回归模型 | 绘制森林图 (forestplot) | 附完整代码 + 注释 (qq.com)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>变量：分类变量，分级变量，数值变量</p> <ul><li>单因素cox（分析某个因素的时候，不考虑其他因素的变化）</li> <li>多因素cox（分析某个因素的同时，还考虑上其他因素的变化）</li></ul> <p>主要的包是：<code>survival</code>，<code>survminer</code><br>
主要的函数是：</p> <ul><li>公式：<code>Surv(Time, Status) ~ Stage</code></li> <li>进行分析：</li> <li><code>survfit(Surv(Time, Status) ~ Stage, data = survival_data)</code></li> <li><code>coxph(Surv(Time, Status) ~ Stage, data = survival_data)</code></li> <li>提取结果：<code>summary(x)</code>，<code>signif(x$wald[&quot;pvalue&quot;], digits = 2)</code></li></ul> <p>主要的结果（要用<code>summary</code>总结）：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>res_cox &lt;- coxph(Surv(Time, Status) ~ Stage, data = tcga_gbmlgg_cli)  
summary(res_cox)  


# Call:  
# coxph(formula = Surv(Time, Status) ~ Stage, data = tcga_gbmlgg_cli)  
#   
# n= 670, number of events= 255   
# (4 observations deleted due to missingness)  
#   
#                   coef exp(coef) se(coef) z Pr(&gt;|z|)      
#   StageWHO III  1.1888    3.2833   0.1995  5.959 2.54e-09 ***  
#   StageWHO IV   2.9183   18.5107   0.2013 14.497  &lt; 2e-16 ***  
#   ---  
#   Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1  
#   
#          exp(coef) exp(-coef) lower .95 upper .95  
# StageWHO III     3.283    0.30458     2.221     4.854  
# StageWHO IV     18.511    0.05402    12.476    27.465  
#   
# Concordance= 0.786  (se = 0.013 )  
# Likelihood ratio test= 276.2  on 2 df,   p=&lt;2e-16  
# Wald test            = 259.6  on 2 df,   p=&lt;2e-16  
# Score (logrank) test = 376.8  on 2 df,   p=&lt;2e-16
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><ul><li><p>coef：模型系数，表示在每个阶段特定条件下，生存时间的对数风险增加了多少</p></li> <li><p>exp(coef)：模型系数的指数，表示相对风险（hazard ratio，也叫风险比，风险率）</p></li> <li><p>se(coef)：模型系数的标准误差，用于表示估计的不确定性</p></li> <li><p>z：z值，用于检验模型系数是否显著，越大系数在统计上越显著</p></li> <li><p>Pr(&gt;|z|)：z值对应的p值，p值非常小，表示这些系数的影响是显著的</p></li> <li><p>Signif.codes：显著性水平，<code>*</code>数量和<code>.</code>分别代表不同显著水平</p></li> <li><p>exp(coef)，表格，提供了模型系数的指数形式，及其对应的95%置信区间</p></li> <li><p>Concordance：模型的性能指标，衡量模型对观测数据的预测能力（0.786已经表示模型的预测能力相对较好）</p></li> <li><p>Likelihoood ratio test，Wald test，Score（logrank） test，不同的检验方法，用于评估模型的拟合质量</p></li></ul> <p>实现代码：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>library(survival)
library(survminer)

tcga_gbmlgg_cli &lt;- readRDS(&quot;./cox_data/tcga_gbmlgg_cli.rds&quot;)
colnames(tcga_gbmlgg_cli) &lt;- c(&quot;Sample&quot;, &quot;Time&quot;, &quot;Status&quot;, &quot;Gender&quot;, &quot;Age&quot;, &quot;IDH_status&quot;, &quot;MGMT_promoter_status&quot;, &quot;Stage&quot;, &quot;Group&quot;)
head(tcga_gbmlgg_cli)



### 单因素cox分析
res_cox &lt;- coxph(Surv(Time, Status) ~ Stage, data = tcga_gbmlgg_cli)
summary(res_cox)
fit &lt;- survfit(Surv(Time, Status) ~ Stage, data = tcga_gbmlgg_cli)
fit
p&lt;-ggsurvplot(fit,
              #pval =TRUE,
              #conf.int =TRUE,
              #xlab = &quot;Time&quot;, 
              #ylab = &quot;Survival probability&quot;,
              #surv.median.line = &quot;hv&quot;,
              #palette = c(&quot;#00599F&quot;,&quot;#d80700&quot;),
              )
p



### 批量 单因素cox 分析
# 提取我们想要关注的 特征
can &lt;- colnames(tcga_gbmlgg_cli)[4:7]
can

# 构建公式，循环对每个特征做单因素cox回归分析
uni_sur &lt;- sapply(can, function(x) as.formula(paste('Surv(Time, Status)~', x)))
uni_sur
uni_cox &lt;- lapply(uni_sur, function(x){coxph(x, data = tcga_gbmlgg_cli)})
uni_cox

# 创建一个列表 uni_results，用于存储每个生存分析模型的结果
uni_results &lt;- lapply(uni_cox, function(x) {
  # lapply的功能：批量进行：x &lt;- uni_cox$IDH_status
  # 从每个模型的摘要中提取相关信息
  x &lt;- summary(x)
  
  # 获取Wald检验的p值并截断为两位小数
  p.value &lt;- signif(x$wald[&quot;pvalue&quot;], digits = 2)
  
  # 获取模型系数的估计值（通常表示风险比HR）并截断为两位小数
  HR &lt;- signif(x$coef[2], digits = 2)
  
  # 获取HR的95%置信区间的下界和上界并截断为两位小数
  HR.confint.lower &lt;- signif(x$conf.int[,&quot;lower .95&quot;], digits = 2)
  HR.confint.upper &lt;- signif(x$conf.int[,&quot;upper .95&quot;], digits = 2)
  
  # 构建HR和其95%置信区间的字符串表示
  HR &lt;- paste0(HR, &quot; (&quot;, HR.confint.lower, &quot;-&quot;, HR.confint.upper, &quot;)&quot;)

  res &lt;- c(p.value, HR) # 创建一个包含p值和HR（以及其95%置信区间）的结果向量

  names(res) &lt;- c(&quot;p.value&quot;, &quot;HR (95% CI)&quot;) # 设置结果向量的名称，便于后续引用
  
  return(res)  # 返回结果向量
})

res_uni_cox &lt;- as.data.frame(t(as.data.frame(uni_results, check.names = FALSE)))
res_uni_cox



### 多因素cox回归分析
mul_cox &lt;- coxph(Surv(Time, Status) ~ Age + IDH_status + MGMT_promoter_status + Stage, data = tcga_gbmlgg_cli)
summary(mul_cox)

x &lt;- summary(mul_cox)
pvalue &lt;- signif(as.matrix(x$coefficients)[ , 5], 2)
HR &lt;- signif(as.matrix(x$coefficients)[ , 2], 2)
low &lt;- signif(x$conf.int[ , 3], 2)
high &lt;- signif(x$conf.int[ , 4], 2)

res_mul_cox &lt;- data.frame(p.value = pvalue, HR = paste0(HR, &quot; (&quot;, low, &quot;-&quot;, high, &quot;)&quot;, sep = &quot;&quot;), stringsAsFactors = F)
res_mul_cox

### 展示结果
pdf(&quot;./cox_data/forest_plot.pdf&quot;, width = 8, height = 8)
ggforest(mul_cox, data = tcga_gbmlgg_cli)
dev.off()
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br></div></div><h2 id="统计分析-logistic"><a href="#统计分析-logistic" class="header-anchor">#</a> 统计分析/Logistic</h2> <p>可能参考的资料：</p> <p><a href="https://bchobby.github.io/posts/7530c0eb90ba987abed63344c71a3995/" target="_blank" rel="noopener noreferrer">【R语言】logistic回归（二）多因素logistic回归 - 编程爱好者博客 (bchobby.github.io)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://blog.csdn.net/qq_42696043/article/details/125306843" target="_blank" rel="noopener noreferrer">【R语言】logistic回归（二）多因素logistic回归_r语言多因素logistic回归-CSDN博客<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="统计分析-lasso"><a href="#统计分析-lasso" class="header-anchor">#</a> 统计分析/LASSO</h2> <p>同一个作者的分享，非常棒！</p> <p><a href="https://mp.weixin.qq.com/s/kSrr6regfAtX4Bw6gSvmgw" target="_blank" rel="noopener noreferrer">基于 LASSO 回归筛选变量以构建预测模型 | 附完整代码 + 注释 (qq.com)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>Lasso回归（Least Absolute Shrinkage and Selection Operator）是一种用于线性回归问题的正则化方法，它可以用来降低模型的复杂性，防止过拟合，并选择重要的特征变量。</p> <p>一些基本的，重要的概念：</p> <ul><li>正则化（Regularization）是一种在机器学习和统计建模中常用的技术，旨在帮助模型更好地泛化到未见过的数据，避免过拟合问题。</li> <li>过拟合（overfitting）是指模型在训练数据上表现得非常好，但在未见过的测试数据上表现较差的情况。</li></ul> <p>三种正则化的方式：</p> <ul><li>LASSO回归，减少特征选择，只要最重要的几个特征（适合寻找确定只有几个因素影响结果的因素）</li> <li>岭回归，减弱特征选择，保留着，但是权重会调整（适合综合全面考虑若干对结果都有影响的因素）</li> <li>弹性回归，综合考虑了前面两个回归的有点，想要筛掉一些特征，又想保留一些特征的时候适合</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>数据格式：行名为患者信息，前两列为OS，OS.time，之后就是对生存时间的影响因素

x &lt;- as.matrix(lasso_data[ , c(3:ncol(lasso_data))])  
y &lt;- as.matrix(Surv(lasso_data$OS.time, lasso_data$OS))

alpha1_fit &lt;- glmnet(x, y, alpha = 1, family = &quot;cox&quot;, nlambda = 100)
plot(alpha1_fit, xvar = &quot;lambda&quot;, label = TRUE) # 回归系数路径图

alpha1.fit.cv &lt;- cv.glmnet(x, y, type.measure = &quot;deviance&quot;, alpha = 1, family = &quot;cox&quot;) # 交叉验证
plot(alpha1.fit.cv) # 交叉验证曲线

print(alpha1.fit.cv) # 打印结果

coef(alpha1.fit.cv, s = alpha1.fit.cv$lambda.1se)

# 特征提取
feature_all &lt;- as.data.frame(as.matrix(coef(alpha1.fit.cv, s = alpha1.fit.cv$lambda.1se)))  
colnames(feature_all) &lt;- &quot;coff&quot;  
feature_opt &lt;-  feature_all %&gt;% filter(abs(coff) &gt; 0)  
rownames(feature_opt)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>感受：这个LASSO分析，主要是用来进一步筛选“危险因素”的统计分析，之后可以进一步COX回归分析之类的。</p> <p>还可以的分析包括：列线图，生存分析，风险因子（这个作者说是三联图）</p> <h2 id="统计分析-nomogram-calibration"><a href="#统计分析-nomogram-calibration" class="header-anchor">#</a> 统计分析/Nomogram+Calibration</h2> <p><a href="https://mp.weixin.qq.com/s/xW4c1Ye8twsHCd_1eyFOWQ" target="_blank" rel="noopener noreferrer">R语言绘图 | 列线图/诺莫图（Nomogram）和校准曲线（Calibration）| 代码注释 + 结果解读 (qq.com)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>一种可视化Logistic或Cox分析结果的方式 -- 列线图（Alignment Diagram），也称诺莫图（Nomogram）</p></div></div>  <div class="page-edit"><!----> <!----> <!----></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/49f65b/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">富集分析</div></a> <a href="/pages/28c669/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">WGCNA</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/49f65b/" class="prev">富集分析</a></span> <span class="next"><a href="/pages/28c669/">WGCNA</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/90dbe8/"><div>
            APA相关综述
            <!----></div></a> <span class="date">06-27</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/f4f4b7/"><div>
            胃癌免疫逃逸的决定因素
            <!----></div></a> <span class="date">06-25</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/0a11dd/"><div>
            胖子CAF
            <!----></div></a> <span class="date">06-21</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:2590643635@qq.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/hongliangfang" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/#/playlist?id=755597173" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2023-2024
    <span>FHL | <a href="https://github.com/xugaoyi/vuepress-theme-vdoing/blob/master/LICENSE" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"><div></div></div></div>
    <script src="/assets/js/app.bd488e07.js" defer></script><script src="/assets/js/2.bdf5b8cf.js" defer></script><script src="/assets/js/49.05223958.js" defer></script><script src="/assets/js/3.365ac406.js" defer></script>
  </body>
</html>
