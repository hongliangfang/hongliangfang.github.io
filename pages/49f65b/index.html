<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>富集分析 | 一盏烛光的微笑灿烂人生</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="https://at.alicdn.com/t/font_3129839_xft6cqs5gc.css">
    <noscript><meta http-equiv="refresh" content="0; url=https://www.youngkbt.cn/noscript/"><style>.theme-vdoing-content { display:none }</noscript>
    <meta name="description" content="学习记录博客">
    <meta name="theme-color" content="#11a8cd">
    <meta name="个人博客" content="科研学习，围炉夜话，奇淫巧计">
    
    <link rel="preload" href="/assets/css/0.styles.c9ffc21e.css" as="style"><link rel="preload" href="/assets/js/app.bd488e07.js" as="script"><link rel="preload" href="/assets/js/2.bdf5b8cf.js" as="script"><link rel="preload" href="/assets/js/48.1b2f1a1b.js" as="script"><link rel="preload" href="/assets/js/3.365ac406.js" as="script"><link rel="prefetch" href="/assets/js/10.b00b53b4.js"><link rel="prefetch" href="/assets/js/100.1b2ba6dd.js"><link rel="prefetch" href="/assets/js/101.e392eb92.js"><link rel="prefetch" href="/assets/js/102.eb0bb162.js"><link rel="prefetch" href="/assets/js/103.9db14406.js"><link rel="prefetch" href="/assets/js/104.6ae6fd5c.js"><link rel="prefetch" href="/assets/js/105.4d79399b.js"><link rel="prefetch" href="/assets/js/106.4e6ff12d.js"><link rel="prefetch" href="/assets/js/107.bc93ee73.js"><link rel="prefetch" href="/assets/js/108.59a000f0.js"><link rel="prefetch" href="/assets/js/109.f01f4422.js"><link rel="prefetch" href="/assets/js/11.346d31c6.js"><link rel="prefetch" href="/assets/js/110.96a96c44.js"><link rel="prefetch" href="/assets/js/111.87fe63df.js"><link rel="prefetch" href="/assets/js/112.c560a316.js"><link rel="prefetch" href="/assets/js/113.6a371b02.js"><link rel="prefetch" href="/assets/js/114.989a4d3e.js"><link rel="prefetch" href="/assets/js/115.b6baafa2.js"><link rel="prefetch" href="/assets/js/116.d469dc20.js"><link rel="prefetch" href="/assets/js/117.0a6bccf0.js"><link rel="prefetch" href="/assets/js/118.9f1ef088.js"><link rel="prefetch" href="/assets/js/119.059ef806.js"><link rel="prefetch" href="/assets/js/12.8d91a638.js"><link rel="prefetch" href="/assets/js/120.75ed11ab.js"><link rel="prefetch" href="/assets/js/121.1896ee22.js"><link rel="prefetch" href="/assets/js/122.a3664290.js"><link rel="prefetch" href="/assets/js/123.5b849c39.js"><link rel="prefetch" href="/assets/js/124.85737d6b.js"><link rel="prefetch" href="/assets/js/125.a95cd42f.js"><link rel="prefetch" href="/assets/js/126.7b1c1645.js"><link rel="prefetch" href="/assets/js/127.64a16fd4.js"><link rel="prefetch" href="/assets/js/128.a07721ba.js"><link rel="prefetch" href="/assets/js/129.9ba86871.js"><link rel="prefetch" href="/assets/js/13.18ed2aa7.js"><link rel="prefetch" href="/assets/js/130.5cdb8138.js"><link rel="prefetch" href="/assets/js/131.d2f31425.js"><link rel="prefetch" href="/assets/js/132.b2286d65.js"><link rel="prefetch" href="/assets/js/133.1229c9ae.js"><link rel="prefetch" href="/assets/js/134.71fad9a0.js"><link rel="prefetch" href="/assets/js/135.ff682301.js"><link rel="prefetch" href="/assets/js/136.9de1870b.js"><link rel="prefetch" href="/assets/js/137.a58bbdcd.js"><link rel="prefetch" href="/assets/js/138.cc768cb1.js"><link rel="prefetch" href="/assets/js/139.9d52d34a.js"><link rel="prefetch" href="/assets/js/14.4bcf7ee9.js"><link rel="prefetch" href="/assets/js/140.b1790e58.js"><link rel="prefetch" href="/assets/js/141.98bceb9f.js"><link rel="prefetch" href="/assets/js/142.0415d712.js"><link rel="prefetch" href="/assets/js/143.851c7187.js"><link rel="prefetch" href="/assets/js/144.ae79e007.js"><link rel="prefetch" href="/assets/js/145.d5020e58.js"><link rel="prefetch" href="/assets/js/146.c3eafa98.js"><link rel="prefetch" href="/assets/js/147.0a6864ec.js"><link rel="prefetch" href="/assets/js/148.bbc4bd28.js"><link rel="prefetch" href="/assets/js/149.489e8cdb.js"><link rel="prefetch" href="/assets/js/15.368d9d2d.js"><link rel="prefetch" href="/assets/js/150.7778d444.js"><link rel="prefetch" href="/assets/js/16.06f68354.js"><link rel="prefetch" href="/assets/js/17.4f8d6256.js"><link rel="prefetch" href="/assets/js/18.8989b2ff.js"><link rel="prefetch" href="/assets/js/19.abb857ca.js"><link rel="prefetch" href="/assets/js/20.e32420cf.js"><link rel="prefetch" href="/assets/js/21.06441c4d.js"><link rel="prefetch" href="/assets/js/22.7fb78c64.js"><link rel="prefetch" href="/assets/js/23.d9193b83.js"><link rel="prefetch" href="/assets/js/24.6487f43a.js"><link rel="prefetch" href="/assets/js/25.11e66938.js"><link rel="prefetch" href="/assets/js/26.c3e43726.js"><link rel="prefetch" href="/assets/js/27.24117748.js"><link rel="prefetch" href="/assets/js/28.fabf32c7.js"><link rel="prefetch" href="/assets/js/29.3a9331f2.js"><link rel="prefetch" href="/assets/js/30.ac5ca451.js"><link rel="prefetch" href="/assets/js/31.36e6c9c0.js"><link rel="prefetch" href="/assets/js/32.2fcf84e2.js"><link rel="prefetch" href="/assets/js/33.a73adf6b.js"><link rel="prefetch" href="/assets/js/34.49c0fb46.js"><link rel="prefetch" href="/assets/js/35.babda623.js"><link rel="prefetch" href="/assets/js/36.56221bac.js"><link rel="prefetch" href="/assets/js/37.5d6d33aa.js"><link rel="prefetch" href="/assets/js/38.a6b592e0.js"><link rel="prefetch" href="/assets/js/39.14a81539.js"><link rel="prefetch" href="/assets/js/4.a64d5c9f.js"><link rel="prefetch" href="/assets/js/40.e94616b3.js"><link rel="prefetch" href="/assets/js/41.4ad9febc.js"><link rel="prefetch" href="/assets/js/42.4825ff11.js"><link rel="prefetch" href="/assets/js/43.6d554f8a.js"><link rel="prefetch" href="/assets/js/44.ed8f011b.js"><link rel="prefetch" href="/assets/js/45.170e103d.js"><link rel="prefetch" href="/assets/js/46.9cc703a7.js"><link rel="prefetch" href="/assets/js/47.ff6af7ea.js"><link rel="prefetch" href="/assets/js/49.05223958.js"><link rel="prefetch" href="/assets/js/5.b1fd9f62.js"><link rel="prefetch" href="/assets/js/50.26aa9f07.js"><link rel="prefetch" href="/assets/js/51.65eba0cc.js"><link rel="prefetch" href="/assets/js/52.5b21c37d.js"><link rel="prefetch" href="/assets/js/53.4f209254.js"><link rel="prefetch" href="/assets/js/54.176923ed.js"><link rel="prefetch" href="/assets/js/55.74f6741d.js"><link rel="prefetch" href="/assets/js/56.383e3c0d.js"><link rel="prefetch" href="/assets/js/57.35b21350.js"><link rel="prefetch" href="/assets/js/58.7ae8fd30.js"><link rel="prefetch" href="/assets/js/59.3d7d7dea.js"><link rel="prefetch" href="/assets/js/6.993d7ad0.js"><link rel="prefetch" href="/assets/js/60.67ba2844.js"><link rel="prefetch" href="/assets/js/61.6c5542cd.js"><link rel="prefetch" href="/assets/js/62.a235dad7.js"><link rel="prefetch" href="/assets/js/63.a3a52fe2.js"><link rel="prefetch" href="/assets/js/64.2b6b610e.js"><link rel="prefetch" href="/assets/js/65.8672534a.js"><link rel="prefetch" href="/assets/js/66.c7281353.js"><link rel="prefetch" href="/assets/js/67.e062f6ac.js"><link rel="prefetch" href="/assets/js/68.446f0688.js"><link rel="prefetch" href="/assets/js/69.f03843ed.js"><link rel="prefetch" href="/assets/js/7.afb33a4c.js"><link rel="prefetch" href="/assets/js/70.466d842a.js"><link rel="prefetch" href="/assets/js/71.87fcb26b.js"><link rel="prefetch" href="/assets/js/72.ccf1092d.js"><link rel="prefetch" href="/assets/js/73.3ad6124b.js"><link rel="prefetch" href="/assets/js/74.17a59372.js"><link rel="prefetch" href="/assets/js/75.6c859470.js"><link rel="prefetch" href="/assets/js/76.674a56ad.js"><link rel="prefetch" href="/assets/js/77.5342f3c1.js"><link rel="prefetch" href="/assets/js/78.154ba5e1.js"><link rel="prefetch" href="/assets/js/79.10901b1c.js"><link rel="prefetch" href="/assets/js/8.5bbd7ae9.js"><link rel="prefetch" href="/assets/js/80.0166104e.js"><link rel="prefetch" href="/assets/js/81.4c5a0e6a.js"><link rel="prefetch" href="/assets/js/82.47099701.js"><link rel="prefetch" href="/assets/js/83.7873cd95.js"><link rel="prefetch" href="/assets/js/84.23000f66.js"><link rel="prefetch" href="/assets/js/85.6701c9e4.js"><link rel="prefetch" href="/assets/js/86.188012c3.js"><link rel="prefetch" href="/assets/js/87.e9cde64e.js"><link rel="prefetch" href="/assets/js/88.5ccdea49.js"><link rel="prefetch" href="/assets/js/89.9ab559de.js"><link rel="prefetch" href="/assets/js/9.6699859e.js"><link rel="prefetch" href="/assets/js/90.bc7fb61d.js"><link rel="prefetch" href="/assets/js/91.07537d0a.js"><link rel="prefetch" href="/assets/js/92.b4ed0bad.js"><link rel="prefetch" href="/assets/js/93.b167c2d0.js"><link rel="prefetch" href="/assets/js/94.1a02653c.js"><link rel="prefetch" href="/assets/js/95.69ef19be.js"><link rel="prefetch" href="/assets/js/96.e0b3f5df.js"><link rel="prefetch" href="/assets/js/97.9ea0c268.js"><link rel="prefetch" href="/assets/js/98.074852d9.js"><link rel="prefetch" href="/assets/js/99.708b118b.js">
    <link rel="stylesheet" href="/assets/css/0.styles.c9ffc21e.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.png" alt="一盏烛光的微笑灿烂人生" class="logo"> <span class="site-name can-hide">一盏烛光的微笑灿烂人生</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="科研学习" class="dropdown-title"><a href="/study/" class="link-title">科研学习</a> <span class="title" style="display:none;">科研学习</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/articles/" class="nav-link">阅读记录</a></li><li class="dropdown-item"><!----> <a href="/biotech/" class="nav-link">生信分析</a></li><li class="dropdown-item"><!----> <a href="/basic/" class="nav-link">整理归纳</a></li></ul></div></div><div class="nav-item"><a href="/wlyh/" class="nav-link">围炉夜话</a></div><div class="nav-item"><a href="/technology/" class="nav-link">奇淫巧计</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/about/" class="nav-link">关于</a></li><li class="dropdown-item"><!----> <a href="/links/" class="nav-link">一些网站</a></li><li class="dropdown-item"><!----> <a href="/friends/" class="nav-link">友情链接</a></li><li class="dropdown-item"><!----> <a href="/passbyworld/" class="nav-link">路过人间</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="https://pica.zhimg.com/v2-f2b30ad5674f652294f0ec6f9b8c9922_720w.webp?source=d16d100b"> <div class="blogger-info"><h3>围炉夜话</h3> <span>知行合一</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="科研学习" class="dropdown-title"><a href="/study/" class="link-title">科研学习</a> <span class="title" style="display:none;">科研学习</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/articles/" class="nav-link">阅读记录</a></li><li class="dropdown-item"><!----> <a href="/biotech/" class="nav-link">生信分析</a></li><li class="dropdown-item"><!----> <a href="/basic/" class="nav-link">整理归纳</a></li></ul></div></div><div class="nav-item"><a href="/wlyh/" class="nav-link">围炉夜话</a></div><div class="nav-item"><a href="/technology/" class="nav-link">奇淫巧计</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/about/" class="nav-link">关于</a></li><li class="dropdown-item"><!----> <a href="/links/" class="nav-link">一些网站</a></li><li class="dropdown-item"><!----> <a href="/friends/" class="nav-link">友情链接</a></li><li class="dropdown-item"><!----> <a href="/passbyworld/" class="nav-link">路过人间</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>阅读记录</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>生信分析</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/9fc671/" class="sidebar-link">生信分析</a></li><li><a href="/pages/902bc2/" class="sidebar-link">转录组</a></li><li><a href="/pages/aebaf3/" class="sidebar-link">表观组</a></li><li><a href="/pages/819cd3/" class="sidebar-link">单细胞-概览</a></li><li><a href="/pages/c81394/" class="sidebar-link">单细胞-ATAC</a></li><li><a href="/pages/9033c2/" class="sidebar-link">单细胞-细胞注释</a></li><li><a href="/pages/e0b862/" class="sidebar-link">单细胞-异质性</a></li><li><a href="/pages/1cd666/" class="sidebar-link">Linux</a></li><li><a href="/pages/a8bb10/" class="sidebar-link">R</a></li><li><a href="/pages/d630fc/" class="sidebar-link">python</a></li><li><a href="/pages/73836e/" class="sidebar-link">基因注释</a></li><li><a href="/pages/49f65b/" aria-current="page" class="active sidebar-link">富集分析</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/49f65b/#反思记录" class="sidebar-link">反思记录</a></li><li class="sidebar-sub-header level2"><a href="/pages/49f65b/#如何理解富集分析" class="sidebar-link">如何理解富集分析？</a></li><li class="sidebar-sub-header level2"><a href="/pages/49f65b/#数据库介绍" class="sidebar-link">数据库介绍</a></li><li class="sidebar-sub-header level2"><a href="/pages/49f65b/#go" class="sidebar-link">GO</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/49f65b/#go数据库" class="sidebar-link">GO数据库</a></li><li class="sidebar-sub-header level3"><a href="/pages/49f65b/#数据准备" class="sidebar-link">数据准备</a></li><li class="sidebar-sub-header level3"><a href="/pages/49f65b/#结果解释" class="sidebar-link">结果解释</a></li><li class="sidebar-sub-header level3"><a href="/pages/49f65b/#结果绘图" class="sidebar-link">结果绘图</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/49f65b/#kegg" class="sidebar-link">KEGG</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/49f65b/#kegg数据库" class="sidebar-link">KEGG数据库</a></li><li class="sidebar-sub-header level3"><a href="/pages/49f65b/#数据准备-2" class="sidebar-link">数据准备</a></li><li class="sidebar-sub-header level3"><a href="/pages/49f65b/#结果解释-2" class="sidebar-link">结果解释</a></li><li class="sidebar-sub-header level3"><a href="/pages/49f65b/#结果绘图-2" class="sidebar-link">结果绘图</a></li><li class="sidebar-sub-header level3"><a href="/pages/49f65b/#kegg富集分析原理" class="sidebar-link">KEGG富集分析原理</a></li><li class="sidebar-sub-header level3"><a href="/pages/49f65b/#超几何检验" class="sidebar-link">超几何检验</a></li><li class="sidebar-sub-header level3"><a href="/pages/49f65b/#多重假设检验校正" class="sidebar-link">多重假设检验校正</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/49f65b/#gsea" class="sidebar-link">GSEA</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/49f65b/#输入数据" class="sidebar-link">输入数据</a></li><li class="sidebar-sub-header level3"><a href="/pages/49f65b/#代码参数" class="sidebar-link">代码参数</a></li><li class="sidebar-sub-header level3"><a href="/pages/49f65b/#结果分析" class="sidebar-link">结果分析</a></li><li class="sidebar-sub-header level3"><a href="/pages/49f65b/#结果可视化" class="sidebar-link">结果可视化</a></li><li class="sidebar-sub-header level3"><a href="/pages/49f65b/#富集分析原理" class="sidebar-link">富集分析原理</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/49f65b/#gsva" class="sidebar-link">GSVA</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/49f65b/#结果分析-2" class="sidebar-link">结果分析</a></li><li class="sidebar-sub-header level3"><a href="/pages/49f65b/#结果可视化-2" class="sidebar-link">结果可视化</a></li></ul></li></ul></li><li><a href="/pages/61f7f0/" class="sidebar-link">临床相关性</a></li><li><a href="/pages/28c669/" class="sidebar-link">WGCNA</a></li><li><a href="/pages/69a308/" class="sidebar-link">Seurat</a></li><li><a href="/pages/784c69/" class="sidebar-link">Scanpy</a></li><li><a href="/pages/44ad24/" class="sidebar-link">Monocle2</a></li><li><a href="/pages/893dcf/" class="sidebar-link">单细胞-轨迹分析</a></li><li><a href="/pages/7989c6/" class="sidebar-link">CellPhoneDB</a></li><li><a href="/pages/dbe3de/" class="sidebar-link">CellChat2</a></li><li><a href="/pages/df4df8/" class="sidebar-link">NicheNet</a></li><li><a href="/pages/5f4d84/" class="sidebar-link">SCENIC</a></li><li><a href="/pages/9f91d0/" class="sidebar-link">单细胞-RNA velocity</a></li><li><a href="/pages/d079f5/" class="sidebar-link">细胞外囊泡</a></li><li><a href="/pages/d7b340/" class="sidebar-link">数据分析和数据挖掘</a></li><li><a href="/pages/c7d198/" class="sidebar-link">数据处理</a></li><li><a href="/pages/e50bac/" class="sidebar-link">data.frame</a></li><li><a href="/pages/500bc4/" class="sidebar-link">ggplot2</a></li><li><a href="/pages/937699/" class="sidebar-link">数据可视化-Python</a></li><li><a href="/pages/6cbee5/" class="sidebar-link">绘图</a></li><li><a href="/pages/5666ad/" class="sidebar-link">统计</a></li><li><a href="/pages/e75428/" class="sidebar-link">想法和借鉴</a></li><li><a href="/pages/7f8ebe/" class="sidebar-link">Algorithm</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>实验技术</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>整理归纳</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/study/#科研学习" data-v-06225672>科研学习</a></li><li data-v-06225672><a href="/study/#生信分析" data-v-06225672>生信分析</a></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="javascript:;" data-v-06225672>FHL</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2023-12-01</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABH1JREFUSA3tVl1oHFUUPmdmd2ltklqbpJDiNnXFmgbFktho7YMPNiJSSZM0+CAYSkUELVhM6YuwIPpgoOKDqOBDC0XE2CQoNtQXBUFTTcCi+Wlh1V2TQExsUzcltd3M9Tt3ZjZzZ2fT+OJTL8yeM+eee757fmeJbq//KQL8X3DUSFOcfr7cRsRtxNQMWueeVzOkaITIGqQHNg5y8+jNW9ldM7A6nTpAjuolUikAwq7CE3WcM2RRDz+XGVgN3FptU/aUSlvq9Pa3iZ1+sgAqJyyAFqkipd9dqiwHF3P65YycLWc/6sqGrvoEoIp6DOFaX5h6+dnfjkWprwqsPk0dUGq5vySwDImC10KxFHgGL1SWoc92O3eVht09qdXNH11I2SsTsJYqMWzihqGMi+A+Garf3BAuuLI5oGlULyNfyB/HYNujwktOfRrMr5t77NmevqaUopx0grnKAyvVpmwUDB4x6FPXuGvYLTDwWsejwgtgkYKPqRJg8SV6xaiZ3ZTppGneS4yfH5/66fZSDHv+QZci/+h5c5UHtpy67JUqGppM0sh0Nc1dW6/N1W5Yoqat8/TU/VnadmdeW2PLLSyh0cvxBs3KbqTmwYPpxN4do/mzE8nEpvX/UMu2Wbp74zUAK5q6WkHns7V0eWkdPbPzd3rxkTGybadYySumVzhcaJFbs5UrEkQ/+CK8gF5dnh/6ciIZ73gwQ927L1IitoxKLXYP3SjYdOrHHfTZhRRlFyrorafPk20B3HPD1y2G3qKZME5Jcf3t/HUC13/8tSd++vqFveMUTwAUxSUFI1QekR1+bIze3D9MF2aq6cPvG72CgnldWCFqyRw3lwH8ZMerjTD9ElRO7Gv44wNpC90aASqGfVlz/Rx17srQ57/UU26hkhQqUB7dBR71WmzQhHUnblGmVOEw0jhbV1n9OlXUDCIRGaNV5Jp43N516fN7JmnTHdfp7Hgy0luO4aMhtkLL8Bi3bUWYvzh5Mn1dTxrL6QmGuRhGL/TiTTxRoEdTszSaq9GR0NGA3KdkOz3hqSV3MIDhQ5IVX/Ivx3umBti2es2h4eZby7x8br1rkf7Mo90AqC8aQ3sJeNzqFRu+vSANAQe3PL7l0HGOAdwDCeZYvNKeoZp1Qfs6Aipndh86HmFRi0LAnEO47wsqM6cdfjh3jBPUzhZy7nvlUfFsamED1VQt6aISHVymXZ/B2aCtIG8AI8xfobj2d3en1wWVhOeHELKmLQ1s211s88comkv4UCwWyF787mJdYXtNfhKAXVqnKTq8QZvGAGGOfaTo5pGZ/PwbUCr5+DPr/1J92JNHr9aOl/F3iI5+O1nfybsGxoimvZ3ViWSluDITw3P37mypheDIPY0tw7+O/5ApbkYw+zpfaUVu32Pi98+defdUhEpZkRFq0aqyNh9FuL9hpYbEm6iwi0z2REd09ZmyENEbuhjDWzKvZXTqKYaBIr3tt5kuPtQBZFvEUwHt60vfCNu41XsksH9Ij1BMMz1Y0OOunHNShFIP5868g5zeXmuLwL9T4b6Q2+KejgAAAABJRU5ErkJggg==">富集分析<!----></h1>  <div class="theme-vdoing-content content__default"><h2 id="反思记录"><a href="#反思记录" class="header-anchor">#</a> 反思记录</h2> <p>如何快速分析呢？输入输出结果如何更加批量化？也就是更快的验证自己想知道的结果？
”API“：输入，输出，
设置好结构，放好位置，然后就是一顿操作猛如虎了~
学习和后续进行应用，是一个整体的过程，要做好衔接，在学的时候就想好如何使用，对吧~</p> <p>还有python版的GSEA分析，嗯，可以参考看看
<a href="01.%E7%A7%91%E7%A0%94%E5%AD%A6%E4%B9%A0/01.%E7%94%9F%E4%BF%A1%E5%88%86%E6%9E%90/01.%E7%BC%93%E5%86%B2--%E7%A7%91%E7%A0%94">缓冲--科研</a>这里</p> <h2 id="如何理解富集分析"><a href="#如何理解富集分析" class="header-anchor">#</a> 如何理解富集分析？</h2> <p>面对外界环境的改变，内部的生物学过程一般不会只有一个分子起作用，一般是一条通路或者是一群分子蛋白在合作着应对外界环境的变化。
我们得到了某一个时刻各种细胞的基因表达量数据，要看是不是某个方面起了作用/变化，最好是分析所有的变量是不是在某一组具有特定功能的群体里显著富集（增多），才更能说明问题。于是有了富集分析。</p> <h2 id="数据库介绍"><a href="#数据库介绍" class="header-anchor">#</a> 数据库介绍</h2> <p>根据参考的基因集，也就是前人研究总结的某个通路上的基因集来源，可以将富集分析分为：
GO term功能，KEGG pathway通路，MSigDB基因集富集</p> <p><a href="https://www.geneontology.org/" target="_blank" rel="noopener noreferrer">Gene Ontology Resource<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>将蛋白分子根据下面三种方式分类：</p> <ul><li>molecular function，分子功能，某个分子的功能</li> <li>cellular component，细胞组分，某个分子的位置</li> <li>biological process，生物过程，某个分子参与的活动</li></ul> <p><a href="https://www.genome.jp/kegg/" target="_blank" rel="noopener noreferrer">KEGG: Kyoto Encyclopedia of Genes and Genomes<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>比较复杂，有很多分类方式：
包括通路，代谢、调控、通路、生化、疾病、药物等相关的分子相互作用和关系网络。
用的最多的是按照通路pathway，这个方面分类的集合</p> <p><a href="https://www.gsea-msigdb.org/gsea/msigdb" target="_blank" rel="noopener noreferrer">GSEA | MSigDB (gsea-msigdb.org)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>也定义了不少基因集合：
分为人类和小鼠两个大类；人的又分了9类；</p> <ul><li>H，hallmark gene sets，能够定义生物学状态或过程的基因集</li> <li>C1，positional gene sets，根据染色体位置定义的基因集</li> <li>C2，curated gene sets，根据数据库，文献，专家定义的基因集</li> <li>C3，regulatory target gene sets，代表转录因子或microRNA 调控的潜在目标的基因集</li> <li>C4，compositional gene sets，根据癌症产生的微阵列数据定义的的基因集</li> <li>C5，oncology gene sets，被注释为一条本体数据上的基因集</li> <li>C6，oncogenic signature gene sets，在癌症中失调的细胞通路特征的基因集</li> <li>C7，immunological signature gene sets，代表免疫系统内细胞状态和扰动的基因集</li> <li>C8，cell type signature gene sets，单细胞数据中定义cluster基因marker的基因集</li></ul> <p>The Molecular Signatures Database (MSigDB) is a resource of tens of thousands of annotated gene sets for use with GSEA software, divided into <a href="https://www.gsea-msigdb.org/gsea/msigdb/human/collections.jsp" target="_blank" rel="noopener noreferrer">Human<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> and <a href="https://www.gsea-msigdb.org/gsea/msigdb/mouse/collections.jsp" target="_blank" rel="noopener noreferrer">Mouse<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> collections.</p> <h2 id="go"><a href="#go" class="header-anchor">#</a> GO</h2> <p>GO富集分析用于从一组感兴趣的基因或蛋白质中（一般是差异基因），找出在Gene Ontology（GO）数据库中富集的，生物学过程（Biological Process）、分子功能（Molecular Function）和细胞组分（Cellular Component）。
GO富集分析和KEGG富集分析做的事情包括原理其实都一样，它们最大的差别是使用的数据库不一样。</p> <h3 id="go数据库"><a href="#go数据库" class="header-anchor">#</a> GO数据库</h3> <p><a href="https://www.geneontology.org/" target="_blank" rel="noopener noreferrer">Gene Ontology Resource/GO数据库<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>是一个由国际合作组织维护的生物信息学资源库，用于对基因和蛋白质的功能进行注释和分类，以便更好地理解生物学过程和分析实验数据。</p> <p>GO数据库的主要内容包括三个主要领域（也称为三个GO本体）：</p> <ul><li><code>生物学过程（Biological Process）</code>：用于描述基因和蛋白质在生物学过程中的活动，例如细胞分裂、信号传导、代谢过程等。</li> <li><code>分子功能（Molecular Function）</code>：用于描述基因和蛋白质在分子水平上的功能，例如酶活性、DNA结合、受体活性等。</li> <li><code>细胞组分（Cellular Component）</code>：用于描述基因和蛋白质在细胞中所处的位置或组分，例如细胞核、细胞膜、线粒体等。</li></ul> <h3 id="数据准备"><a href="#数据准备" class="header-anchor">#</a> 数据准备</h3> <p>使用的数据一般是差异分析之后得到的类似“差异基因”的数据，最低要求input是 <strong>一列基因名的字符串</strong>，多一些对应的P值或logFC的话，可以用来筛选和排序</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>library(ggpubr) #绘图使用  
library(ggplot2) # 绘图使用  
library(clusterProfiler) #KEGG富集分析使用  
library(org.Hs.eg.db) #转换基因ID使用  
library(stats) #数据处理使用  
library(data.table) #数据读取使用  
library(dplyr) #数据处理使用  
  
BRCA_Mathc_DEG &lt;- fread(&quot;BRCA_Match_DEG.txt&quot;,data.table = F)  
##差异基因筛选,也可以根据自己的需要选择 
DEG_data &lt;- BRCA_Mathc_DEG %&gt;% dplyr::filter(abs(logFC) &gt; 2 &amp; FDR &lt; 0.05)  

#Gene名转化为GeneID  
gene.df&lt;-bitr(DEG_data$gene_id,fromType=&quot;SYMBOL&quot;,#fromType数据ID类型是属于哪一类  
                toType=c(&quot;ENTREZID&quot;,&quot;SYMBOL&quot;),#toType要转换成哪种ID类型，可以写多种，也可以只写一种  
                OrgDb=org.Hs.eg.db)#Orgdb是指对应的注释包
  
colnames(gene.df)[1] &lt;- &quot;gene_id&quot;  
DEG_data1 &lt;- left_join(gene.df,DEG_data)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>和KEGG富集分析一样，差异基因的选择也可以单独选择上调或下调基因分别进行富集分析。GO富集分析时，也需要将GeneID从SYMBOL转换成ENTREZID。由于数据是人类数据，因此选择<code>org.Hs.eg.db</code>数据集。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>GO_all &lt;- enrichGO(gene = enrich_data$EntrezID,#基因列表(转换的ID)  
                   keyType = &quot;ENTREZID&quot;,#指定的基因ID类型，默认为ENTREZID  
                   OrgDb = org.Mm.eg.db,#物种对应的org包  
                   ont = &quot;ALL&quot;,     #CC细胞组件，MF分子功能，BF生物学过程，ALL以上三个  
                   pvalueCutoff = 0.01, #p值阈值  
                   pAdjustMethod = &quot;fdr&quot;,#多重假设检验校正方式  
                   minGSSize=10,       #注释的最小基因集，默认为10  
                   maxGSSize=500,      #注释的最大基因集，默认为500  
                   qvalueCutoff=0.01,        #q值阈值  
                   readable = TRUE)          #基因ID转换为基因名 
                   
GO_result &lt;- data.frame(GO_all)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="结果解释"><a href="#结果解释" class="header-anchor">#</a> 结果解释</h3> <p>GO富集分析结果一共有10列</p> <ul><li><code>ONTOLOGY</code>：表示BP、CC、MF`中的哪一类</li> <li><code>ID：</code>GO通路或功能类别的唯一标识符。</li> <li><code>Description：</code>GO通路的描述，即通路或功能的名称或注释。</li> <li><code>GeneRatio：</code>输入的差异基因中，映射到此GO通路的基因数目/映射到某一过程(BP/CC/MF之一)所有GO通路的基因总数目。</li> <li><code>BgRatio：</code>在整个基因数据库（或背景基因集合）中映射到GO通路的基因数目，以及该通路中的总基因数目。</li> <li><code>pvalue、p.adjust和qvalue：</code>p值、校正后p值和q值；</li> <li><code>geneID：</code>映射到该通路的基因的标识符列表，这里转换成基因名SYMBOL了。</li> <li><code>Count：</code>在富集分析中映射到该通路或功能类别的基因数目，即GeneRatio列中的第一个值。</li></ul> <h3 id="结果绘图"><a href="#结果绘图" class="header-anchor">#</a> 结果绘图</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>## 自带的绘图  
## 条形图
barplot(GO_all,showCategory=20)  

## 点图
dotplot(GO_all,showCategory=15)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>但是，这样直接展示出来的话不知道属于哪种GO通路的哪一类，所以可以自己调整一下</p> <div class="language- line-numbers-mode"><pre class="language-text"><code># GO三种类别，每种选择显著性最高的12个展示出来  
go_pathway &lt;- GO_result %&gt;% group_by(ONTOLOGY) %&gt;% top_n(n = 20, wt = -p.adjust)  


# 纵向柱状图  
ggplot(go_enrichment_pathway, aes(x=reorder(Description, -Count), y=Count, fill=ONTOLOGY)) +  
  geom_bar(stat=&quot;identity&quot;, position=position_dodge(width=0.8), width=0.6) +  
  theme_minimal() +  
  labs(x=&quot;GO Term&quot;, y=&quot;Gene_Number&quot;, title=&quot;Top 10 Enriched GO Terms&quot;) +  
  facet_grid(ONTOLOGY~., scale = 'free_y', space = 'free_y')+  
  coord_flip() +  #让柱状图变为纵向  
  scale_fill_manual(values=c(&quot;CC&quot;=&quot;skyblue&quot;,&quot;BP&quot;=&quot;pink&quot;,&quot;MF&quot;=&quot;lightgreen&quot;))+  
  theme_bw()
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code># 横向柱状图 
ggplot(go_enrichment_pathway,aes(x=reorder(Description,-Count),y=Count,fill=ONTOLOGY))+# 定义x、y轴; 根据ONTOLOGY填充颜色  
  geom_bar(stat=&quot;identity&quot;,width=0.8)+#柱状图宽度  
  scale_fill_manual(values=c(&quot;CC&quot;=&quot;skyblue&quot;,&quot;BP&quot;=&quot;pink&quot;,&quot;MF&quot;=&quot;lightgreen&quot;))+#柱状图填充颜色  
  facet_grid(.~ONTOLOGY,scale='free_x',space='free_x')+  
  labs(x=&quot;GO Term&quot;, y=&quot;Gene_Number&quot;, title=&quot;Top 200 Enriched GO Terms&quot;)+  
  theme_bw() +  
  theme(axis.text.x=element_text(family=&quot;sans&quot;,face=&quot;bold&quot;,color=&quot;gray50&quot;,angle=70,vjust=1, hjust = 1))#对字体样式、颜色、还有横坐标角度（）
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code># 绘制气泡图  
ggplot(go_enrichment_pathway, aes(x=reorder(Description, Count), y=Count)) +  
  geom_point(aes(size=Count,color=-log10(p.adjust))) +  
  scale_size_continuous(range=c(1, 10)) +  
  facet_grid(ONTOLOGY~., scale = 'free_y', space = 'free_y')+  
  coord_flip() +  #让柱状图变为纵向  
  theme_minimal() +  
  scale_color_gradient(low = &quot;pink&quot;,high =&quot;red&quot;)+  
  labs(color=expression(-log10(p.adjust),size=&quot;Count&quot;),   
       x=&quot;Gene Ratio&quot;,y=&quot;Gene_Number&quot;,title=&quot;GO Enrichment&quot;)+  
  theme_bw()
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="kegg"><a href="#kegg" class="header-anchor">#</a> KEGG</h2> <p>KEGG富集分析（Kegg Enrichment Analysis）是一种生物信息学分析方法，
用于从一组感兴趣的基因或蛋白质中，找出在KEGG数据库中富集的生物学通路。
这种分析方法可以帮助我们理解基因集合中的功能分布和生物学过程，从而揭示基因集合的生物学意义和潜在的功能。</p> <h3 id="kegg数据库"><a href="#kegg数据库" class="header-anchor">#</a> KEGG数据库</h3> <p><a href="https://www.genome.jp/kegg/" target="_blank" rel="noopener noreferrer">KEGG: Kyoto Encyclopedia of Genes and Genomes<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>是一个全球公认的生物信息学数据库，用于解释高级功能和生物系统功能的分子水平信息，特别关注基因组、基因功能和生物化学通路等方面。KEGG数据库提供了对生物学、生物化学和生物信息学领域的多种信息资源，包括基因和蛋白质的功能注释、代谢通路、信号通路、药物目标等信息。</p> <p>先介绍KEGG富集分析的R语言实现以及绘图，原理放在最后，需要的可以看一下。</p> <h3 id="数据准备-2"><a href="#数据准备-2" class="header-anchor">#</a> 数据准备</h3> <p>使用的数据一般是差异分析之后得到的类似“差异基因”的数据，最低要求input是 <strong>一列基因名的字符串</strong>，多一些对应的P值或logFC的话，可以用来筛选和排序</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>library(ggplot2) # 绘图使用   
library(clusterProfiler) #KEGG富集分析使用   
library(org.Hs.eg.db) #转换基因ID使用   
library(stats) #数据处理使用   
library(data.table) #数据读取使用   
library(dplyr) #数据处理使用

BRCA_Mathc_DEG &lt;- fread(&quot;./data/RawData/BRCA_Match_DEG.txt&quot;,data.table = F)   
DEG_data &lt;- BRCA_Mathc_DEG %&gt;% dplyr::filter(abs(logFC) &gt; 2 &amp; FDR &lt; 0.05) #数据筛选   

#Gene名转化为GeneID   
gene.df &lt;- bitr(DEG_data$gene_id, 
	fromType = &quot;SYMBOL&quot;, #fromType数据ID类型是属于哪一类的                   
	toType = c(&quot;ENTREZID&quot;, &quot;SYMBOL&quot;), #toType要转换成哪种ID类型，一种或两种都可以              
	OrgDb = org.Hs.eg.db) #Orgdb对应的注释包
colnames(gene.df)[1] &lt;- &quot;gene_id&quot; 
DEG_data1 &lt;- left_join(gene.df,DEG_data)

# KEGG富集分析时，需要将GeneID从SYMBOL转换成ENTREZID，由于数据是人类数据因此选择`org.Hs.eg.db`数据集

## KEGG富集分析   
kegg &lt;- enrichKEGG(DEG_data1$ENTREZID,
	organism = 'human', 
	pvalueCutoff = 0.05,
	pAdjustMethod = 'BH', 
	minGSSize = 3, 
	maxGSSize = 500, 
	qvalueCutoff = 0.05,
	use_internal_data = FALSE)      
kegg_result &lt;- data.frame(kegg)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><ul><li><code>organism = 'human'：</code>这是指定要进行KEGG富集分析的生物学物种。</li> <li><code>pvalueCutoff = 0.05：</code>用于过滤富集分析结果的原始p-value的阈值。</li> <li><code>pAdjustMethod = 'BH'：</code>指定用于校正多重假设检验的方法。在这里，使用的是Benjamini-Hochberg方法，通常用于控制假阳性率（False Discovery Rate，FDR）。</li> <li><code>minGSSize = 3：</code>富集分析中考虑的最小基因集合大小。</li> <li><code>maxGSSize = 500：</code>富集分析中考虑的最大基因集合大小。</li> <li><code>qvalueCutoff = 0.05：</code>用于过滤富集分析结果的校正后q-value的阈值。</li> <li><code>use_internal_data = FALSE：</code>是否使用内部数据集进行富集分析。如果设置为TRUE，将使用内部数据集，否则将从KEGG网站下载数据。</li></ul> <h3 id="结果解释-2"><a href="#结果解释-2" class="header-anchor">#</a> 结果解释</h3> <p>富集分析结果共有9列，这里解释一下各列代表的含义。</p> <ul><li><code>ID：</code>KEGG通路或功能类别的唯一标识符。</li> <li><code>Description：</code>KEGG通路或功能类别的描述，即通路或功能的名称或注释。</li> <li><code>GeneRatio：</code>输入的差异基因中，映射到此KEGG通路的基因数目/映射到所有KEGG通路的基因总数目。</li> <li><code>BgRatio：</code>在整个基因数据库（或背景基因集合）中映射到KEGG通路的基因数目，以及该通路中的总基因数目。</li> <li><code>pvalue、p.adjust和qvalue：</code>p值、校正后p值和q值；</li> <li><code>geneID：</code>映射到该通路的基因的标识符列表，通常是ENTREZID。</li> <li><code>Count：</code>在富集分析中映射到该通路或功能类别的基因数目，即GeneRatio列中的第一个值。</li></ul> <h3 id="结果绘图-2"><a href="#结果绘图-2" class="header-anchor">#</a> 结果绘图</h3> <p>我们可以使用富集分析包中自带的绘图函数来进行绘图，也可以通过结果根据需要进行绘图。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code># 自带的绘图

## 条形图   
barplot(kegg, drop = TRUE, showCategory = 15,color = &quot;p.adjust&quot;,title = &quot;KEGG Pathway&quot;)

## 气泡图   
dotplot(kegg, showCategory=15)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>根据需要自己绘图</p> <div class="language- line-numbers-mode"><pre class="language-text"><code># 根据p-value值排序，选择显著的通路或功能（这里设定阈值为0.05）   
significant_pathways &lt;- subset(enrichment_results, p.adjust &lt; 0.05) 

# 绘制基于ggplot2的条形图   
ggplot(significant_pathways, aes(x = reorder(Description, -log10(p.adjust)), y = -log10(p.adjust))) +
	geom_bar(stat = &quot;identity&quot;, fill = &quot;skyblue&quot;) +
	labs(title = &quot;KEGG Pathway Enrichment Analysis&quot;, x = &quot;Pathway&quot;, y = &quot;-log10(P-value)&quot;) +
	theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
	coord_flip() 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code># 设置颜色的阶梯和对应的颜色   significant_pathways$pvalue_group &lt;- cut(significant_pathways$p.adjust, breaks = c(0, 0.001, 0.01, 0.05), labels = c(&quot;p &lt; 0.001&quot;, &quot;0.001 &lt;= p &lt; 0.01&quot;, &quot;0.01 &lt;= p &lt; 0.05&quot;))      

# 绘制基于ggplot2的气泡图   
ggplot(significant_pathways, aes(x = reorder(Description, -log10(p.adjust)), y = -log10(p.adjust))) +
	geom_point(aes(size = Count, color = pvalue_group), alpha = 0.7) +
	scale_size_continuous(range = c(1, 10)) +
	labs(title = &quot;KEGG Pathway Enrichment Analysis&quot;,x = &quot;Pathway&quot;,y = &quot;-log10(P-value)&quot;,size = &quot;Count&quot;,color = &quot;P-value&quot;) +     
	theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
	coord_flip()+
scale_color_manual(values = c(&quot;p &lt; 0.001&quot; = &quot;#DC0000B2&quot;, &quot;0.001 &lt;= p &lt; 0.01&quot; = &quot;#F39B7FB2&quot;, &quot;0.01 &lt;= p &lt; 0.05&quot; = &quot;#4DBBD5B2&quot;))
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="kegg富集分析原理"><a href="#kegg富集分析原理" class="header-anchor">#</a> KEGG富集分析原理</h3> <p>基因富集分析是通过研究给定的基因集在功能节点上是否过出现得到关注的基因集显著注释的功能节点。
通常利用<code>超几何分布等</code>方法计算给定基因集在某个功能（或通路）上的<code>P</code>值，判断给定的基因集在功能（或通路）的基因数目超过了随机的期望，是一个小概率事件。</p> <h3 id="超几何检验"><a href="#超几何检验" class="header-anchor">#</a> 超几何检验</h3> <p>假设KEGG数据库中总共有<code>M</code>个基因，其中包含<code>m</code>个基因与某个<code>KEGG</code>通路或功能类别相关；
在感兴趣的基因集合中，总共有<code>N</code>个基因，其中包含<code>n</code>个基因与该<code>KEGG</code>通路或功能类别相关。
超几何检验的目标是评估从总体（KEGG数据库中）中抽取N个基因，在其中包含n个与该通路或功能相关的基因的概率，与从总体中抽取N个基因，在其中包含m个与该通路或功能相关的基因的概率之间的差异。</p> <p>超几何检验的公式
<img src="https://cdn.statically.io/gh/hongliangfang/picx-images-hosting@master/study/%E8%B6%85%E5%87%A0%E4%BD%95%E6%A3%80%E9%AA%8C%E5%85%AC%E5%BC%8F.lyaecpxu3nk.webp" alt="超几何检验公式">
其中，<strong>P(X ≥ n) 表示从总体中抽取N个基因，至少有n个与该通路或功能相关的基因的概率。超几何检验的p-value就是该概率。</strong></p> <h3 id="多重假设检验校正"><a href="#多重假设检验校正" class="header-anchor">#</a> 多重假设检验校正</h3> <p>在进行KEGG富集分析时，需要考虑多个KEGG通路或功能类别的比较，这会导致多重假设检验的问题。多重假设检验可能导致出现假阳性结果，即错误地将某些通路或功能类别标记为富集。为了控制多重假设检验带来的误差，通常使用多重检验校正方法。<strong>常见的方法包括Bonferroni校正和Benjamini-Hochberg（BH）校正。</strong>
KEGG富集分析的数学原理主要涉及超几何检验来判断富集程度，并使用多重假设检验校正来控制多个比较带来的误差，从而获得显著富集的KEGG通路。</p> <h2 id="gsea"><a href="#gsea" class="header-anchor">#</a> GSEA</h2> <p>GSEA，Gene Set Enrichment Analysis， 基于基因集进行的富集分析
利用全部的表达基因集，根据基因排序和富集得分，全面显示通路上的功能作用。</p> <h3 id="输入数据"><a href="#输入数据" class="header-anchor">#</a> 输入数据</h3> <ul><li>基因列表，差异分析之后的基因列表（和GO/KEGG不同，不需要筛选）</li> <li>基因集，数据库中基因集，或者自定义的数据集</li></ul> <h3 id="代码参数"><a href="#代码参数" class="header-anchor">#</a> 代码参数</h3> <p>示例基因集是<a href="https://www.gsea-msigdb.org/gsea/msigdb" target="_blank" rel="noopener noreferrer">MSigDB<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>library(ggplot2) #画图使用  
library(clusterProfiler) #GSEA富集/数据读取使用  
library(GSEABase) #GSEA富集使用  
library(dplyr) #数据处理使用  
library(data.table) #数据读取使用  
  
geneSet &lt;- read.gmt(&quot;./Enrichment_analysis/h.all.v2023.1.Hs.symbols.gmt&quot;) #下载的基因集  
BRCA_Mathc_DEG &lt;- fread(&quot;./data/RawData/BRCA_Match_DEG.txt&quot;,data.table = F)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>基因如何排序？log FC或P值，两个结合或单选一个来排序，等其他方法</p> <div class="language- line-numbers-mode"><pre class="language-text"><code># 1、直接使用logFC作为排序依据  
geneList &lt;- BRCA_Mathc_DEG$logFC #获取GeneList  
names(geneList) &lt;- BRCA_Mathc_DEG$gene_id #使用转换好的ID，对GeneList命名  
geneList &lt;- sort(geneList, decreasing = T) #从高到低排序  
  
GSEA_enrichment &lt;- GSEA(geneList, #排序后的gene  
                        TERM2GENE = geneSet, #基因集  
                        pvalueCutoff = 0.05, #P值阈值  
                        minGSSize = 10, #最小基因数量  
                        maxGSSize = 500, #最大基因数量  
                        eps = 0, #P值边界  
                        pAdjustMethod = &quot;BH&quot;) #校正P值的计算方法  
  
result &lt;- data.frame(GSEA_enrichment)  
dim(GSEA_enrichment@result)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="结果分析"><a href="#结果分析" class="header-anchor">#</a> 结果分析</h3> <p>（会展示出显著富集的基因集）</p> <ul><li><code>ID</code>: 基因集的标识符或名称。</li> <li><code>Description</code>: 基因集的描述或注释，通常是对基因集功能、通路或生物学过程的解释。</li> <li><code>setSize</code>: 基因集中包含的基因数量。</li> <li><code>enrichmentScore</code>: 富集得分（Enrichment Score），它是一个反映基因集在基因表达数据中富集程度的统计量。</li> <li><code>NES</code>: 标准化富集得分（Normalized Enrichment Score），它是将富集得分标准化后的值，使得不同基因集的富集得分可比较。</li> <li><code>pvalue</code>: 这一列表示富集得分的显著性水平（p-value），用于衡量基因集在基因表达数据中的显著性富集。</li> <li><code>p.adjust</code>: 这一列表示多重比较校正后的p-value，通常使用FDR或其他方法进行校正。</li> <li><code>qvalue</code>: 这一列表示估计的FDR（False Discovery Rate），用于控制多重假设检验引起的假阳性。</li> <li><code>rank</code>: 基因集在排序后的基因列表中的排名。</li> <li><code>leading_edge</code>: 这一列指示哪些基因在计算富集得分时对富集结果产生了主要贡献。
<ul><li>tags=60%: 这表示60%的基因集中的基因在富集分析中对结果产生了影响。</li> <li>list=10%: 这表示在富集分析中使用的整体基因列表（gene list）中，有10%的基因在该基因集中。</li> <li>signal=55%: 这表示在整个基因集中，有55%的基因在样本中显示出富集信号，即在表达数据中呈现出差异表达的特征。(由tags和list计算得来)。</li></ul></li> <li><code>core_enrichment</code>: 这一列指示哪些基因是核心富集基因，对于形成富集得分起关键作用。</li></ul> <h3 id="结果可视化"><a href="#结果可视化" class="header-anchor">#</a> 结果可视化</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>## 展示最显著的15个通路  
dotplot(GSEA_enrichment,showCategory=15,color=&quot;p.adjust&quot;)

## 将通路分为激活和抑制两个部分  
dotplot(GSEA_enrichment,split = &quot;.sign&quot;)+facet_grid(~.sign)+  
  theme(plot.title = element_text(size = 10,color=&quot;black&quot;,hjust = 0.5),  
        axis.title = element_text(size = 10,color =&quot;black&quot;),   
        axis.text = element_text(size= 10,color = &quot;black&quot;),  
        axis.text.x = element_text(angle = 45, hjust = 1 ),  
        legend.position = &quot;top&quot;,  
        legend.text = element_text(size= 10),  
        legend.title= element_text(size= 10))

#特定通路作图  
library(enrichplot)  
#看一下缺氧通路  
gseaplot2(GSEA_enrichment,&quot;HALLMARK_HYPOXIA&quot;,color=&quot;red&quot;,pvalue_table = T)

#同时看多个通路  
#缺氧通路+脂肪酸代谢通路  
gseaplot2(GSEA_enrichment,c(&quot;HALLMARK_HYPOXIA&quot;,&quot;HALLMARK_FATTY_ACID_METABOLISM&quot;),color=c(&quot;red&quot;,&quot;blue&quot;),pvalue_table = T)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>注意，排序方式会对结果造成影响</p> <h3 id="富集分析原理"><a href="#富集分析原理" class="header-anchor">#</a> 富集分析原理</h3> <p>三个步骤
1、计算富集分数，ES：沿着基因列表，计算基因集的，富集得分
2、估计ES的显著性水平，P值： #不懂
3、调整多重假设检验，归一化富集分数NES，错误发现率FDR ： #不懂</p> <h2 id="gsva"><a href="#gsva" class="header-anchor">#</a> GSVA</h2> <p>GSVA，Gene Set Variation Analysis，计算每个样本中的基因集富集水平，将基因表达数据从个体基因的水平转换为基因集（如生物学过程，通路，功能的基因集合）的富集程度</p> <p>输入数据</p> <ul><li>样本的表达矩阵，</li> <li>基因集，</li></ul> <p>示例基因集是<a href="https://www.gsea-msigdb.org/gsea/msigdb" target="_blank" rel="noopener noreferrer">MSigDB<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>library(ggplot2) #绘图使用  
library(ComplexHeatmap) #绘图使用  
library(clusterProfiler) #数据处理使用  
library(GSVA) #GSVA使用  
library(GSEABase) #数据处理使用  
library(dplyr) #数据处理使用  
library(data.table) #数据读取使用  

TCGA_BRCA_Exp_tpm &lt;- fread(&quot;./Enrichment_analysis/TCGA_BRCA_Exp_tpm.txt&quot;,data.table = F)  
gene_set &lt;- getGmt(&quot;./Enrichment_analysis/h.all.v2023.1.Hs.symbols.gmt&quot;)  
TCGA_BRCA_Exp_tpm &lt;- TCGA_BRCA_Exp_tpm[!duplicated(TCGA_BRCA_Exp_tpm$gene_name),] ## 去除重复基因  
gsva_data &lt;- TCGA_BRCA_Exp_tpm[,-1] #去掉第一列样本名  
rownames(gsva_data) &lt;- TCGA_BRCA_Exp_tpm$gene_name #行名为基因名
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code># 这里需要注意的是，输入的表达数据需要`matrix`格式的
gsva_result &lt;- gsva(as.matrix(gsva_data), gene_set, method = &quot;gsva&quot;,min.sz=1, max.sz=Inf,kcdf=&quot;Poisson&quot;,parallel.sz=1L)

参数解读
- method: GSVA算法的选择。这里选择了&quot;gsva&quot;，也可以选择&quot;&quot;ssgsea。
- gene_set: 基因集，用于富集分析的基因集合。
- min.sz: 基因集中允许的最小基因数。默认为1，表示允许基因集中只包含一个基因。
- max.sz: 基因集中允许的最大基因数。默认为Inf，表示没有最大限制，可以包含任意多个基因。
- kcdf: 核密度估计的核函数类型。输入counts值使用&quot;Poisson&quot;。输入标准化之后的值(tpm/fpkm)，需要使用&quot;Gaussian&quot;。
- parallel.sz: 并行计算的规模。设置为1L，表示使用单线程计算。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="结果分析-2"><a href="#结果分析-2" class="header-anchor">#</a> 结果分析</h3> <p>下一步做什么分析呢？</p> <ul><li>聚类，根据GSVA得到的样本富集得分，可以对样本进行聚类分析</li> <li>差异分析，使用limma包进行差异分析，获得差异通路</li> <li>机器学习/深度学习模型输入，构建分类器，对样本进行预测，例如将肿瘤样本与正常样本进行区分，或预测不同临床亚型</li> <li>与表型关联，得分和临床数据相关联/生物学表型相关联</li></ul> <h3 id="结果可视化-2"><a href="#结果可视化-2" class="header-anchor">#</a> 结果可视化</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>## 结果绘制热图  
library(dendextend)  
library(circlize)  
library(RColorBrewer)  
colors = colorRampPalette(rev(brewer.pal(n = 7, name =&quot;RdYlBu&quot;)))(100)  
values &lt;- seq(-0.8, 0.8, length.out = 101)[-101]  
col_fun = colorRamp2(values, colors)  
  
# 创建注释对象  
annotation_data &lt;- data.frame(c(rep(&quot;normal&quot;,111),rep(&quot;tumor&quot;,111)))  
colnames(annotation_data) &lt;- &quot;Type&quot;  
top_annotation &lt;- HeatmapAnnotation(df = annotation_data, col = list(Type = c(&quot;normal&quot; = &quot;blue&quot;, &quot;tumor&quot; = &quot;red&quot;)))  
Heatmap(gsva_result, name = &quot;GSVA&quot;, col = col_fun,cluster_rows = T,cluster_columns = F,show_row_names = F,  
        show_column_names = F,top_annotation = top_annotation,column_split = annotation_data$Type)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>一部分参考：</p> <p><a href="https://mp.weixin.qq.com/s?__biz=MzIxMDExNDE0OQ==&amp;mid=2247484571&amp;idx=1&amp;sn=feecd2d8b17f946acd40873ffdc1d82f&amp;chksm=9768c791a01f4e87951cb4dbdeb44e1b9cfdd9a377275eb9146ba0cefe2e9a675e4f63b67e3d&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer">R绘图实战|GSEA富集分析图 (qq.com)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div></div>  <div class="page-edit"><!----> <div class="tags"><a href="/tags/?tag=%E4%BB%A3%E7%A0%81" title="标签">#代码</a></div> <!----></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/73836e/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">基因注释</div></a> <a href="/pages/61f7f0/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">临床相关性</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/73836e/" class="prev">基因注释</a></span> <span class="next"><a href="/pages/61f7f0/">临床相关性</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/90dbe8/"><div>
            APA相关综述
            <!----></div></a> <span class="date">06-27</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/f4f4b7/"><div>
            胃癌免疫逃逸的决定因素
            <!----></div></a> <span class="date">06-25</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/0a11dd/"><div>
            胖子CAF
            <!----></div></a> <span class="date">06-21</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:2590643635@qq.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/hongliangfang" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/#/playlist?id=755597173" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2023-2024
    <span>FHL | <a href="https://github.com/xugaoyi/vuepress-theme-vdoing/blob/master/LICENSE" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"><div></div></div></div>
    <script src="/assets/js/app.bd488e07.js" defer></script><script src="/assets/js/2.bdf5b8cf.js" defer></script><script src="/assets/js/48.1b2f1a1b.js" defer></script><script src="/assets/js/3.365ac406.js" defer></script>
  </body>
</html>
